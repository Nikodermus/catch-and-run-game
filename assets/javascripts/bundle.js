!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=120)}({1:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},120:function(e,t,n){"use strict";function o(e){e||(e={});var t=Object.create(e);return t.name=t.name,t.x=t.x,t.y=t.x,t.width=t.width,t.height=t.height,t.s_modifier=t.s_modifier,t.health=t.s_modifier*Me.health*Ce.modifier,t.x_pos=t.x_pos,t.x_neg=t.x_neg,t.y_pos=t.y_pos,t.y_neg=t.y_neg,t.image=new Image,t.sound=new Howl({src:["./assets/sounds/"+t.name+".wav"]}),t.death=new Howl({src:["./assets/sounds/"+t.name+"_death.wav"]}),t.die=function(){this.death.play(),Ie=_e,Ce.score+=Math.floor(50*Ce.catches*Ce.modifier),Oe.health<=0&&(Oe=Se),ne.health<=0&&(ne=Se)},t}function r(e){e||(e={});var t=Object.create(e);return t.name=t.name,t.x=t.x,t.y=t.y,t.width=37,t.height=33,t.explanation=t.explanation,t.do=t.do,t.image=new Image,t.sound=new Howl({src:["./assets/sounds/power_up.wav"]}),t}function i(e){var t=Object.create(e);return t.active=!0,t.damage=Ce.projectile_rule.damage,t.velocity=Ce.projectile_rule.speed,t.width=Ce.projectile_rule.width,t.height=Ce.projectile_rule.height,t.color=Ce.projectile_rule.color,t.flag=w(),t.impact=new Howl({src:["./assets/sounds/impact.wav"]}),t.insideCanvas=function(){return t.x>=0&&t.x<=te.width&&t.y>=0&&t.y<=te.height},t.draw=function(){ae.fillStyle=this.color,ae.fillRect(this.x,this.y,this.width,this.height)},t.update=function(){this.flag.y_pos&&this.flag.x_pos?(t.x+=t.velocity,t.y+=t.velocity):this.flag.x_neg&&this.flag.y_pos?(t.x-=t.velocity,t.y+=t.velocity):this.flag.x_pos&&this.flag.y_neg?(t.x+=t.velocity,t.y-=t.velocity):this.flag.x_neg&&this.flag.y_neg?(t.x-=t.velocity,t.y-=t.velocity):!this.flag.x_pos||this.flag.y_pos||this.flag.y_neg||this.flag.x_neg?!this.flag.x_neg||this.flag.y_pos||this.flag.y_neg||this.flag.x_pos?!this.flag.y_pos||this.flag.x_pos||this.flag.x_neg||this.flag.y_neg?t.y-=t.velocity:t.y+=t.velocity:t.x-=t.velocity:t.x+=t.velocity,t.active=t.active&&t.insideCanvas()},t.explotion=function(){self=this,self.impact.play(),self.damage=0,self.velocity=0;for(var e=0;e<5;e++)!function(e){setTimeout(function(){this.x-=(1.01*this.width-this.width)/2,this.y-=(1.01*this.height-this.height)/2,self.color=E(self.color,"#b02626",e/10),self.width*=1.01,self.height*=1.01},50)}(e);setTimeout(function(){self.active=!1},251)},t}function a(e){Ce.production||console.log(e)}function s(e){(void 0===e?"undefined":C(e))===Array&&(e=e[0]);var t=document.createElement("div");t.classList="error",t.innerHTML="Oops: "+e,document.body.appendChild(t),setTimeout(function(){document.body.removeChild(t)},3e3)}function d(e,t){return e.x<=t.x+t.width&&t.x<=e.x+e.width&&e.y<=t.y+t.height&&t.y<=e.y+e.height}function u(){var e=Ce.difficulty,t=document.querySelector("#global [data-user=id]").innerText;jQuery.ajax({type:"POST",url:Pe+"/users/"+t+"/games/",data:{game:{difficulty:e}},success:function(e,t,n){a("ajax start game"),e.success?l(e.game):s("Game won't be saved")},error:function(e,t,n){s("Game won't be saved")}})}function c(e){(0,B.default)(ce,{width:ce.clientWidth,height:ce.clientHeight,onrendered:function(t){e(t.toDataURL("image/jpg"))}})}function l(e){ue.forEach(function(t){t.innerText=e[t.dataset.game]})}function p(e){a("ajax end game");var t=document.querySelector("#global [data-user=id]").innerText,n=document.querySelector("#global [data-game=id]").innerText,o=Number(R.innerText);jQuery.ajax({type:"PATCH",url:Pe+"/users/"+t+"/games/"+n,data:{game:{id:n,score:o,img_path:e}},success:function(e,t,n){}})}function h(e){var t=[ye,ve,we,be,xe,Ee,Te,Ae,ke,Me,Be],n=[],o=[];oe=3,Ce.menu_sound.stop(),Ce.modifier=e;var r=!0,i=!1,a=void 0;try{for(var s,d=t[Symbol.iterator]();!(r=(s=d.next()).done);r=!0){var u=s.value;o.push("./assets/images/"+u.name+".png");for(var c=1;c<9;c++)o.push("./assets/images/"+u.name+"_"+c+".png")}}catch(e){i=!0,a=e}finally{try{!r&&d.return&&d.return()}finally{if(i)throw a}}f(m,n,0,o)}function f(e,t,n,o){a("load game");for(var r in o){var i=new Image;t.push(i),i.onload=function(){n++,U.style.top=-n/o.length*110+"%",n>=o.length&&e()},i.src=o[r]}}function m(){v(),S(),u()}function g(){ae.restore(),Oe=Se,Ce.catches=0,Ce.score=0,U.style.visibility="visible",U.style.top=0,oe=3,Y.style.visibility="hidden",a("new game")}function _(e,t){return Math.random()*(t-e)+e}function y(){return ee=_(0,30),ee<7?"imp"!==Oe.name?Object.create(ye):Object.create(ve):ee<13?"revenant"!==Oe.name?Object.create(ve):Object.create(we):ee<18?"baron"!==Oe.name?Object.create(we):Object.create(be):ee<22?"knight"!==Oe.name?Object.create(be):Object.create(xe):ee<25?"cyberdemon"!==Oe.name?Object.create(xe):Object.create(Ee):ee<27?"cacodemon"!==Oe.name?Object.create(Ee):Object.create(Te):ee<30?"mancubus"!==Oe.name?Object.create(Te):Object.create(Ae):"spider"!==Oe.name?Object.create(Ae):Object.create(ye)}function v(){a("reseted game"),ne=Se,Me.killable=!0,Ce.playable=!1,Ce.pause_sound.play(),N.src="",V.innerText="",W.style.visibility="hidden",Y.style.visibility="hidden",oe=3,Me.projectiles=[],A(),Oe=Ce.catches<4?Object.create(ye):Ce.catches<8?Object.create(ve):Ce.catches<12?Object.create(we):Ce.catches<15?Object.create(be):Ce.catches<17?Object.create(xe):Ce.catches<21?Object.create(Ee):Ce.catches<26?Object.create(Te):Ce.catches<29?Object.create(Ae):Object.create(ke),Me.shoot=function(){Me.projectiles.push(i({speed:Ce.projectile_rule.speed,x:Me.x+Me.width/2,y:Me.y+Me.height/2})),Ce.projectile_rule.sound.play()};var e=_(0,20);e<6?Ie=_e:e<10?Ie=pe:e<14?Ie=he:e<17?Ie=fe:e<18?Ie=me:e<19?Ie=ge:e<20&&(Ie=re),Me.x=te.width/2,Me.y=te.height/2,Oe.x=Oe.width/2+Math.random()*(te.width-Oe.width),Oe.y=Oe.width/2+Math.random()*(te.height-Oe.width),Oe.x>.5*te.width-te.width*Ce.safe_area&&Oe.x<.5*te.width+te.width*Ce.safe_area&&(Oe.x-=te.width*Ce.safe_area),Oe.y>.5*te.height-te.height*Ce.safe_area&&Oe.y<.5*te.height+te.height*Ce.safe_area&&(Oe.y-=te.height*Ce.safe_area),Be.x=32+Math.random()*(te.width-64),Be.y=32+Math.random()*(te.height-64),e>6&&(Ie.x=Ie.width/2+Math.random()*(te.width-Ie.width),Ie.y=Ie.width/2+Math.random()*(te.height-Ie.width)),Ce.playable=!1,Ce.pause_sound.play(),z.style.visibility="visible",z.style.opacity=1;for(var t=0;t<3;t++)setTimeout(function(){z.innerHTML="<span>"+oe+"</span>",oe--,z.style.opacity-=.25},700*t);setTimeout(function(){z.style.opacity=0,z.style.visibility="hidden",Ce.playable=!0,Ce.play_sound.play(),oe=3},2101)}function w(){var e={x_pos:!1,y_pos:!1,x_neg:!1,y_neg:!1};return se>Me.x&&(e.x_pos=!0,e.x_neg=!1),de>Me.y&&(e.y_pos=!0,e.y_neg=!1),se<Me.x&&(e.x_neg=!0,e.x_pos=!1),de<Me.y&&(e.y_neg=!0,e.y_pos=!1),de>Me.y&&de<Me.y+Me.height&&(e.y_neg=!1,e.y_pos=!1),se>Me.x&&se<Me.x+Me.width&&(e.x_neg=!1,e.x_pos=!1),e}function b(){return Ce.playable&&"hidden"===W.style.visibility&&"hidden"===Y.style.visibility&&"hidden"===z.style.visibility}function x(e){a("game over"),114===e&&g(),Ce.lifes>0?v():(Me.sound.play(),Y.style.visibility="visible",Ce.playable=!1,Ce.pause_sound.play(),c(p))}function E(e,t,n){var o=parseInt(e.slice(1),16),r=parseInt(t.slice(1),16),i=o>>16,a=o>>8&255,s=255&o,d=r>>16,u=r>>8&255,c=255&r;return"#"+(16777216+65536*(Math.round((d-i)*n)+i)+256*(Math.round((u-a)*n)+a)+(Math.round((c-s)*n)+s)).toString(16).slice(1)}function T(e){if(b()){Me.projectiles.forEach(function(e){e.update(),d(e,Oe)&&(Oe.health-=e.damage,e.explotion(),Oe.health<=0&&ne.die()),d(e,ne)&&(ne.health-=e.damage,e.explotion(),ne.health<=0&&ne.die())}),Me.projectiles=Me.projectiles.filter(function(e){return e.active}),Me.x>Oe.x&&(Oe.x+=Oe.speed*e,Oe.x_pos=!0,Oe.x_neg=!1,Oe.x>te.width-Oe.width&&(Oe.x=te.width-Oe.width,Oe.x_pos=!1)),Me.x<Oe.x&&(Oe.x-=Oe.speed*e,Oe.x_neg=!0,Oe.x_pos=!1,Oe.x<0&&(Oe.x=0,Oe.x_neg=!1)),Me.y>Oe.y&&(Oe.y+=Oe.speed*e,Oe.y_pos=!0,Oe.y_neg=!1,Oe.y>te.height-Oe.height&&(Oe.y=te.height-Oe.height,Oe.y_pos=!1)),Me.y<Oe.y&&(Oe.y-=Oe.speed*e,Oe.y_neg=!0,Oe.y_pos=!1,Oe.y<0&&(Oe.y=0,Oe.y_neg=!1)),Oe.x===Me.x&&(Oe.x_pos=!1,Oe.x_neg=!1),Oe.y===Me.y&&(Oe.y_pos=!1,Oe.y_neg=!1),Me.x>ne.x&&(ne.x+=ne.speed*e,ne.x_pos=!0,ne.x_neg=!1,ne.x>te.width-ne.width&&(ne.x=te.width-ne.width,ne.x_pos=!1)),Me.x<ne.x&&(ne.x-=ne.speed*e,ne.x_neg=!0,ne.x_pos=!1,ne.x<0&&(ne.x=0,ne.x_neg=!1)),Me.y>ne.y&&(ne.y+=ne.speed*e,ne.y_pos=!0,ne.y_neg=!1,ne.y>te.height-ne.height&&(ne.y=te.height-ne.height,ne.y_pos=!1)),Me.y<ne.y&&(ne.y-=ne.speed*e,ne.y_neg=!0,ne.y_pos=!1,ne.y<0&&(ne.y=0,ne.y_neg=!1)),ne.x===Me.x&&(ne.x_pos=!1,ne.x_neg=!1),ne.y===Me.y&&(ne.y_pos=!1,ne.y_neg=!1),Me.x<Be.x&&(Be.x+=Be.speed*e,Be.x_pos=!0,Be.x_neg=!1,Be.x>te.width-Be.width&&(Be.x=te.width-Be.width,Be.x_pos=!1)),Me.x>Be.x&&(Be.x-=Be.speed*e,Be.x_neg=!0,Be.x_pos=!1,Be.x<0&&(Be.x=0,Be.x_neg=!1)),Me.y<Be.y&&(Be.y+=Be.speed*e,Be.y_pos=!0,Be.y_neg=!1,Be.y>te.height-Be.height&&(Be.y=te.height-Be.height,Be.y_pos=!1)),Me.y>Be.y&&(Be.y-=Be.speed*e,Be.y_neg=!0,Be.y_pos=!1,Be.y<0&&(Be.y=0,Be.y_neg=!1)),Be.x===Me.x&&(Be.x_pos=!1,Be.x_neg=!1),Be.y===Me.y&&(Be.y_pos=!1,Be.y_neg=!1);[Oe,ne,Be].forEach(function(e,t){e.y_pos&&e.x_pos?e.image.src="./assets/images/"+e.name+"_2.png":e.x_pos&&e.y_neg?e.image.src="./assets/images/"+e.name+"_4.png":e.x_neg&&e.y_neg?e.image.src="./assets/images/"+e.name+"_6.png":e.x_neg&&e.y_pos?e.image.src="./assets/images/"+e.name+"_8.png":!e.y_pos||e.x_pos||e.x_neg?!e.x_pos||e.y_pos||e.y_neg||e.x_neg?!e.x_neg||e.y_pos||e.y_neg||e.x_pos?!e.y_neg||e.x_pos||e.x_neg||e.y_pos?e.y_pos||e.y_neg||e.x_pos||e.x_neg||(e.image.src="./assets/images/"+e.name+".png"):e.image.src="./assets/images/"+e.name+"_5.png":e.image.src="./assets/images/"+e.name+"_7.png":e.image.src="./assets/images/"+e.name+"_3.png":e.image.src="./assets/images/"+e.name+"_1.png"}),87 in le&&(Me.y-=Me.speed*e,Me.y_pos=!0,Me.y_neg=!1,Me.y<0&&(Me.y=0)),83 in le&&(Me.y+=Me.speed*e,Me.y_neg=!0,Me.y_pos=!1,Me.y>te.height-Me.height&&(Me.y=te.height-Me.height)),65 in le&&(Me.x-=Me.speed*e,Me.x_neg=!0,Me.x_pos=!1,Me.x<0&&(Me.x=0)),68 in le&&(Me.x+=Me.speed*e,Me.x_pos=!0,Me.x_neg=!1,Me.x>te.width-Me.width&&(Me.x=te.width-Me.width)),Me.y_pos&&Me.x_pos?Me.image.src="./assets/images/"+Me.name+"_2.png":Me.x_pos&&Me.y_neg?Me.image.src="./assets/images/"+Me.name+"_4.png":Me.x_neg&&Me.y_neg?Me.image.src="./assets/images/"+Me.name+"_6.png":Me.x_neg&&Me.y_pos?Me.image.src="./assets/images/"+Me.name+"_8.png":!Me.y_pos||Me.x_pos||Me.x_neg?!Me.x_pos||Me.y_pos||Me.y_neg||Me.x_neg?!Me.x_neg||Me.y_pos||Me.y_neg||Me.x_pos?!Me.y_neg||Me.x_pos||Me.x_neg||Me.y_pos?Me.image.src="./assets/images/"+Me.name+".png":Me.image.src="./assets/images/"+Me.name+"_5.png":Me.image.src="./assets/images/"+Me.name+"_7.png":Me.image.src="./assets/images/"+Me.name+"_3.png":Me.image.src="./assets/images/"+Me.name+"_1.png",d(Me,Be)&&(Ce.catches++,ne!=Se&&(Ce.score+=100*Ce.modifier),Ce.score+=100*Ce.modifier,Be.sound.play(),Me.killable=!0,v()),d(Me,Oe)&&(Me.killable?(Oe.sound.play(),Ce.lifes--,Ce.lifes>=3?D.src="./assets/images/3_lifes.gif":Ce.lifes>0&&(D.src="./assets/images/"+Ce.lifes+"_lifes.gif"),x()):(Oe.health=0,Oe.die())),d(Me,ne)&&(Me.killable?(ne.sound.play(),Ce.lifes--,Ce.lifes<1?x():v(),D.src="./assets/images/"+Ce.lifes+"_lifes.gif"):(ne.health=0,ne.die())),d(Me,Ie)&&("white"!==N.name&&"blue"!==N.name||(N.src="./assets/images/"+Ie.name+".png"),Be.sound.play(),V.classList.add(Ie.name),Ie.do(),V.innerText=Ie.explanation(Me,Oe,ne),ae.clearRect(Ie.x,Ie.y,Ie.width,Ie.height),Ie=_e)}}function A(){L.innerHTML="",Ce.lifes>5&&(Ce.lifes=5);for(var e=0;e<Ce.lifes;e++){var t=J.cloneNode();L.appendChild(t)}}function k(){ae.clearRect(0,0,te.width,te.height),R.innerText=Ce.score<10?"0"+Ce.score:Ce.score,Ce.production||(ae.beginPath(),ae.lineWidth="3",ae.strokeStyle="blue",ae.rect(Me.x,Me.y,Me.width,Me.height),ae.stroke(),ae.beginPath(),ae.lineWidth="3",ae.strokeStyle="green",ae.rect(Be.x,Be.y,Be.width,Be.height),ae.stroke(),ae.beginPath(),ae.lineWidth="3",ae.strokeStyle="red",ae.rect(Oe.x,Oe.y,Oe.width,Oe.height),ae.stroke()),Me.projectiles.forEach(function(e){e.draw()}),ae.drawImage(Me.image,Me.x,Me.y),ae.drawImage(Be.image,Be.x,Be.y),ae.drawImage(Oe.image,Oe.x,Oe.y),Ie.image.src="./assets/images/"+Ie.name+".png",ae.drawImage(Ie.image,Ie.x,Ie.y),ne!==Se&&(ae.drawImage(ne.image,ne.x,ne.y),Ce.production||(ae.beginPath(),ae.lineWidth="3",ae.strokeStyle="red",ae.rect(ne.x,ne.y,ne.width,ne.height),ae.stroke()))}function S(){var e=Date.now();T((e-ie)/1e3),k(),ie=e,requestAnimationFrame(S)}function I(){W.style.visibility="hidden",Ce.playable=!0,Ce.play_sound.play()}function O(){W.style.visibility="visible",Ce.playable=!1,Ce.pause_sound.play()}var C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M=n(121),B=function(e){return e&&e.__esModule?e:{default:e}}(M);n(122),jQuery.noConflict();var P=void 0,R=void 0,L=void 0,D=void 0,N=void 0,F=void 0,j=void 0,H=void 0,W=void 0,G=void 0,q=void 0,V=void 0,U=void 0,z=void 0,X=void 0,$=void 0,Q=void 0,Y=void 0,K=void 0,J=void 0,Z=void 0,ee=void 0,te=void 0,ne=void 0,oe=void 0,re=void 0,ie=void 0,ae=void 0,se=void 0,de=void 0,ue=void 0,ce=void 0,le={},pe={},he={},fe={},me={},ge={},_e={},ye={},ve={},we={},be={},xe={},Ee={},Te={},Ae={},ke={},Se={},Ie={},Oe={},Ce={playable:!1,production:!0,difficulty:"easy",lifes:3,x0:0,y0:0,catches:0,score:0,modifier:1,power_up:"",pause_sound:new Howl({src:["./assets/sounds/pause.mp3"],volume:.3,loop:!0}),play_sound:new Howl({src:["./assets/sounds/play.mp3"],volume:.3,loop:!0}),menu_sound:new Howl({src:["./assets/sounds/menu.mp3"],volume:.3,autoplay:!0}),loaded:!1,monster_rules:{speed:1,health:1},projectile_rule:{name:"shoot",speed:4,damage:5,width:5,height:5,color:"#66BF38",sound:new Howl({src:["./assets/sounds/shoot.wav"],volume:.2})}},Me={name:"marine",speed:256,x:0,y:0,width:38,height:56,health:400,killable:!0,weapon_size:20,x_pos:!1,x_neg:!1,y_pos:!1,y_neg:!1,projectiles:[],image:new Image,sound:new Howl({src:["./assets/sounds/marine.wav"]})},Be={name:"lost_soul",x:0,y:0,width:40,height:40,speed:.3*Me.speed*Ce.modifier,x_pos:!1,x_neg:!1,y_pos:!1,y_neg:!1,image:new Image,sound:new Howl({src:["./assets/sounds/lost_soul.wav"]})},Pe=Ce.production?"http://game.api.dakio.co":"http://localhost:3000";jQuery(document).ajaxSend(function(e,t){Cookies.get("device_token")&&t.setRequestHeader("APP-DEVICE-TOKEN",Cookies.get("device_token")),Cookies.get("token")&&t.setRequestHeader("APP-TOKEN",Cookies.get("token"))}),document.onclick=function(){Ce.playable&&Me.shoot()},document.onmousemove=function(e){se=e.pageX-64,de=e.pageY-64},window.onresize=function(){Ce.loaded&&(te.width=P.clientWidth-128,te.height=P.clientHeight-128)},window.onload=function(){Ce.loaded=!0,ye=o({name:"imp",width:41,height:57,s_modifier:.3,health:300}),ve=o({name:"revenant",width:49,height:71,s_modifier:.35,h_modifier:.65}),we=o({name:"baron",width:49,height:74,s_modifier:.4,h_modifier:.8}),be=o({name:"knight",width:52,height:74,s_modifier:.45,h_modifier:.85}),xe=o({name:"cyberdemon",width:85,height:109,s_modifier:.55,h_modifier:.9}),Ee=o({name:"cacodemon",width:63,height:65,s_modifier:.65,h_modifier:.7}),Te=o({name:"mancubus",width:164,height:140,s_modifier:.6,h_modifier:1.4}),Ae=o({name:"spider",width:194,height:106,s_modifier:.7,h_modifier:1.3}),ke=o({name:"final_boss",width:746,height:310,s_modifier:.5,h_modifier:3}),Se=o({}),ne=Se,pe=r({name:"yellow",explanation:function(e,t,n){return t.name+" speed increased"},do:function(){Ce.monster_rules.speed*=1.3}}),ge=r({name:"white",explanation:function(e,t,n){return"Indestructible"},do:function(){Me.killable=!1}}),he=r({name:"red",explanation:function(e,t,n){return n.name+" appeared"},do:function(){var e=y();return e.x=0,e.y=0,e.x_neg=!1,e.x_pos=!1,e.y_pos=!1,e.y_neg=!1,ne=e}}),me=r({name:"blue",explanation:function(e,t,n){return"Hero speed increased"},do:function(){Me.speed*=1.2}}),fe=r({name:"green",explanation:function(e,t,n){return t.name+" speed decreased"},do:function(){Ce.monster_rules.speed*=.8}}),re=r({name:"life",explanation:function(e,t,n){return"Life added"},do:function(){Ce.lifes++,A()}}),_e=r({name:"empty",explanation:function(e,t,n){return""}}),Ce.menu_sound.play(),P=document.getElementById("canvas_container"),R=document.getElementById("souls_count"),L=document.getElementById("life_count"),D=document.getElementById("player_status"),N=document.getElementById("power_active"),F=document.getElementById("pause_game"),j=document.getElementById("reload_game"),H=document.getElementById("close_menu"),W=document.getElementById("pause_menu"),G=document.querySelector(".menu_overlay"),q=document.querySelector(".menu_container"),V=document.getElementById("power_up_text"),U=document.getElementById("main_menu"),z=document.getElementById("count_down"),X=document.getElementById("easy_level"),$=document.getElementById("normal_level"),Q=document.getElementById("hardcore_level"),Y=document.getElementById("game_over"),K=document.getElementById("restart_game"),Z=document.getElementById("reload_window"),ce=document.getElementById("game_container"),ue=document.querySelectorAll(".game_info"),J=document.createElement("img"),J.src="./assets/images/life.png",W.style.visibility="hidden",z.style.visibility="hidden",Y.style.visibility="hidden",te=document.createElement("canvas"),ae=te.getContext("2d"),te.width=P.clientWidth-128,te.height=P.clientHeight-128,P.appendChild(te),Ce.safe_area=.2/Ce.modifier,Me.image.src="./assets/images/"+Me.name+".png",Be.image.src="./assets/images/lost_soul.png",ye.speed=Me.speed*ye.s_modifier*Ce.modifier*Ce.monster_rules.speed,ye.image.src="./assets/images/imp.png",ve.speed=Me.speed*ve.s_modifier*Ce.modifier*Ce.monster_rules.speed,ve.image.src="./assets/images/revenant.png",we.speed=Me.speed*we.s_modifier*Ce.modifier*Ce.monster_rules.speed,we.image.src="./assets/images/baron.png",be.speed=Me.speed*be.s_modifier*Ce.modifier*Ce.monster_rules.speed,be.image.src="./assets/images/knight.png",xe.speed=Me.speed*be.s_modifier*Ce.modifier*Ce.monster_rules.speed,xe.image.src="./assets/images/cyberdemon.png",Ee.speed=Me.speed*Ee.s_modifier*Ce.modifier*Ce.monster_rules.speed,Ee.image.src="./assets/images/cacodemon.png",Te.speed=Me.speed*Te.s_modifier*Ce.modifier*Ce.monster_rules.speed,Te.image.src="./assets/images/mancubus.png",Ae.speed=Me.speed*Ae.s_modifier*Ce.modifier*Ce.monster_rules.speed,Ae.image.src="./assets/images/spider.png",ke.speed=Me.speed*ke.s_modifier*Ce.modifier*Ce.monster_rules.speed,ke.image.src="./assets/images/final_boss.png",Se.name="empty",Se.health=0,addEventListener("keydown",function(e){le[e.keyCode]=!0},!1),addEventListener("keyup",function(e){delete le[e.keyCode],Object.keys(le).length<=0&&(Me.y_pos=!1,Me.y_neg=!1,Me.x_pos=!1,Me.x_neg=!1),65===e.keycode&&(Me.x_neg=!1),68===e.keycode&&(Me.x_pos=!1),83===e.keycode&&(Me.y_neg=!1),87===e.keycode&&(Me.y_pos=!1)},!1),X.addEventListener("click",function(){h(.7),Ce.difficulty="easy"}),$.addEventListener("click",function(){h(1),Ce.difficulty="normal"}),Q.addEventListener("click",function(){h(1.3),Ce.difficulty="hard"}),Ce.play_sound.on("play",function(){Ce.pause_sound.pause()}),Ce.pause_sound.on("play",function(){Ce.play_sound.pause()});var e=window;requestAnimationFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame||e.mozRequestAnimationFrame,q.addEventListener("click",function(e){e.stopPropagation()},!1),H.addEventListener("click",I,!1),G.addEventListener("click",I,!1),F.addEventListener("click",O,!1),document.addEventListener("blur",O,!1),K.addEventListener("click",function(){Ce.lifes=3,Ce.catches=0,l({id:""}),m(),v()},!1),j.addEventListener("click",function(){g()},!1),Z.addEventListener("click",function(){g()},!1),F.addEventListener("click",O,!1),V.innerText="",ie=Date.now(),a("game fully laoded")}},121:function(e,t,n){(function(t){var n,n;!function(t){e.exports=t()}(function(){var e;return function e(t,o,r){function i(s,d){if(!o[s]){if(!t[s]){var u="function"==typeof n&&n;if(!d&&u)return n(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=o[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n||e)},l,l.exports,e,t,o,r)}return o[s].exports}for(var a="function"==typeof n&&n,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(n,o,r){(function(t){!function(n){function i(e){throw new RangeError(R[e])}function a(e,t){for(var n=e.length,o=[];n--;)o[n]=t(e[n]);return o}function s(e,t){var n=e.split("@"),o="";return n.length>1&&(o=n[0]+"@",e=n[1]),e=e.replace(P,"."),o+a(e.split("."),t).join(".")}function d(e){for(var t,n,o=[],r=0,i=e.length;r<i;)t=e.charCodeAt(r++),t>=55296&&t<=56319&&r<i?(n=e.charCodeAt(r++),56320==(64512&n)?o.push(((1023&t)<<10)+(1023&n)+65536):(o.push(t),r--)):o.push(t);return o}function u(e){return a(e,function(e){var t="";return e>65535&&(e-=65536,t+=N(e>>>10&1023|55296),e=56320|1023&e),t+=N(e)}).join("")}function c(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:E}function l(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function p(e,t,n){var o=0;for(e=n?D(e/S):e>>1,e+=D(e/t);e>L*A>>1;o+=E)e=D(e/L);return D(o+(L+1)*e/(e+k))}function h(e){var t,n,o,r,a,s,d,l,h,f,m=[],g=e.length,_=0,y=O,v=I;for(n=e.lastIndexOf(C),n<0&&(n=0),o=0;o<n;++o)e.charCodeAt(o)>=128&&i("not-basic"),m.push(e.charCodeAt(o));for(r=n>0?n+1:0;r<g;){for(a=_,s=1,d=E;r>=g&&i("invalid-input"),l=c(e.charCodeAt(r++)),(l>=E||l>D((x-_)/s))&&i("overflow"),_+=l*s,h=d<=v?T:d>=v+A?A:d-v,!(l<h);d+=E)f=E-h,s>D(x/f)&&i("overflow"),s*=f;t=m.length+1,v=p(_-a,t,0==a),D(_/t)>x-y&&i("overflow"),y+=D(_/t),_%=t,m.splice(_++,0,y)}return u(m)}function f(e){var t,n,o,r,a,s,u,c,h,f,m,g,_,y,v,w=[];for(e=d(e),g=e.length,t=O,n=0,a=I,s=0;s<g;++s)(m=e[s])<128&&w.push(N(m));for(o=r=w.length,r&&w.push(C);o<g;){for(u=x,s=0;s<g;++s)(m=e[s])>=t&&m<u&&(u=m);for(_=o+1,u-t>D((x-n)/_)&&i("overflow"),n+=(u-t)*_,t=u,s=0;s<g;++s)if(m=e[s],m<t&&++n>x&&i("overflow"),m==t){for(c=n,h=E;f=h<=a?T:h>=a+A?A:h-a,!(c<f);h+=E)v=c-f,y=E-f,w.push(N(l(f+v%y,0))),c=D(v/y);w.push(N(l(c,0))),a=p(n,_,o==r),n=0,++o}++n,++t}return w.join("")}function m(e){return s(e,function(e){return M.test(e)?h(e.slice(4).toLowerCase()):e})}function g(e){return s(e,function(e){return B.test(e)?"xn--"+f(e):e})}var _="object"==typeof r&&r&&!r.nodeType&&r,y="object"==typeof o&&o&&!o.nodeType&&o,v="object"==typeof t&&t;v.global!==v&&v.window!==v&&v.self!==v||(n=v);var w,b,x=2147483647,E=36,T=1,A=26,k=38,S=700,I=72,O=128,C="-",M=/^xn--/,B=/[^\x20-\x7E]/,P=/[\x2E\u3002\uFF0E\uFF61]/g,R={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},L=E-T,D=Math.floor,N=String.fromCharCode;if(w={version:"1.3.2",ucs2:{decode:d,encode:u},decode:h,encode:f,toASCII:g,toUnicode:m},"function"==typeof e&&"object"==typeof e.amd&&e.amd)e("punycode",function(){return w});else if(_&&y)if(o.exports==_)y.exports=w;else for(b in w)w.hasOwnProperty(b)&&(_[b]=w[b]);else n.punycode=w}(this)}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){function o(e,t,n){!e.defaultView||t===e.defaultView.pageXOffset&&n===e.defaultView.pageYOffset||e.defaultView.scrollTo(t,n)}function r(e,t){try{t&&(t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e.getContext("2d").getImageData(0,0,e.width,e.height),0,0))}catch(t){s("Unable to copy canvas content from",e,t)}}function i(e,t){for(var n=3===e.nodeType?document.createTextNode(e.nodeValue):e.cloneNode(!1),o=e.firstChild;o;)!0!==t&&1===o.nodeType&&"SCRIPT"===o.nodeName||n.appendChild(i(o,t)),o=o.nextSibling;return 1===e.nodeType&&(n._scrollTop=e.scrollTop,n._scrollLeft=e.scrollLeft,"CANVAS"===e.nodeName?r(e,n):"TEXTAREA"!==e.nodeName&&"SELECT"!==e.nodeName||(n.value=e.value)),n}function a(e){if(1===e.nodeType){e.scrollTop=e._scrollTop,e.scrollLeft=e._scrollLeft;for(var t=e.firstChild;t;)a(t),t=t.nextSibling}}var s=e("./log");t.exports=function(e,t,n,r,s,d,u){var c=i(e.documentElement,s.javascriptEnabled),l=t.createElement("iframe");return l.className="html2canvas-container",l.style.visibility="hidden",l.style.position="fixed",l.style.left="-10000px",l.style.top="0px",l.style.border="0",l.width=n,l.height=r,l.scrolling="no",t.body.appendChild(l),new Promise(function(t){var n=l.contentWindow.document;l.contentWindow.onload=l.onload=function(){var e=setInterval(function(){n.body.childNodes.length>0&&(a(n.documentElement),clearInterval(e),"view"===s.type&&(l.contentWindow.scrollTo(d,u),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||l.contentWindow.scrollY===u&&l.contentWindow.scrollX===d||(n.documentElement.style.top=-u+"px",n.documentElement.style.left=-d+"px",n.documentElement.style.position="absolute")),t(l))},50)},n.open(),n.write("<!DOCTYPE html><html></html>"),o(e,d,u),n.replaceChild(n.adoptNode(c),n.documentElement),n.close()})}},{"./log":13}],3:[function(e,t,n){function o(e){this.r=0,this.g=0,this.b=0,this.a=null;this.fromArray(e)||this.namedColor(e)||this.rgb(e)||this.rgba(e)||this.hex6(e)||this.hex3(e)}o.prototype.darken=function(e){var t=1-e;return new o([Math.round(this.r*t),Math.round(this.g*t),Math.round(this.b*t),this.a])},o.prototype.isTransparent=function(){return 0===this.a},o.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},o.prototype.fromArray=function(e){return Array.isArray(e)&&(this.r=Math.min(e[0],255),this.g=Math.min(e[1],255),this.b=Math.min(e[2],255),e.length>3&&(this.a=e[3])),Array.isArray(e)};var r=/^#([a-f0-9]{3})$/i;o.prototype.hex3=function(e){var t=null;return null!==(t=e.match(r))&&(this.r=parseInt(t[1][0]+t[1][0],16),this.g=parseInt(t[1][1]+t[1][1],16),this.b=parseInt(t[1][2]+t[1][2],16)),null!==t};var i=/^#([a-f0-9]{6})$/i;o.prototype.hex6=function(e){var t=null;return null!==(t=e.match(i))&&(this.r=parseInt(t[1].substring(0,2),16),this.g=parseInt(t[1].substring(2,4),16),this.b=parseInt(t[1].substring(4,6),16)),null!==t};var a=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;o.prototype.rgb=function(e){var t=null;return null!==(t=e.match(a))&&(this.r=Number(t[1]),this.g=Number(t[2]),this.b=Number(t[3])),null!==t};var s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;o.prototype.rgba=function(e){var t=null;return null!==(t=e.match(s))&&(this.r=Number(t[1]),this.g=Number(t[2]),this.b=Number(t[3]),this.a=Number(t[4])),null!==t},o.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},o.prototype.namedColor=function(e){e=e.toLowerCase();var t=d[e];if(t)this.r=t[0],this.g=t[1],this.b=t[2];else if("transparent"===e)return this.r=this.g=this.b=this.a=0,!0;return!!t},o.prototype.isColor=!0;var d={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};t.exports=o},{}],4:[function(t,n,o){function r(e,t){var n=E++;if(t=t||{},t.logging&&(_.options.logging=!0,_.options.start=Date.now()),t.async=void 0===t.async||t.async,t.allowTaint=void 0!==t.allowTaint&&t.allowTaint,t.removeContainer=void 0===t.removeContainer||t.removeContainer,t.javascriptEnabled=void 0!==t.javascriptEnabled&&t.javascriptEnabled,t.imageTimeout=void 0===t.imageTimeout?1e4:t.imageTimeout,t.renderer="function"==typeof t.renderer?t.renderer:h,t.strict=!!t.strict,"string"==typeof e){if("string"!=typeof t.proxy)return Promise.reject("Proxy must be used when rendering url");var o=null!=t.width?t.width:window.innerWidth,r=null!=t.height?t.height:window.innerHeight;return w(l(e),t.proxy,document,o,r,t).then(function(e){return a(e.contentWindow.document.documentElement,e,t,o,r)})}var s=(void 0===e?[document.documentElement]:e.length?e:[e])[0];return s.setAttribute(x+n,n),i(s.ownerDocument,t,s.ownerDocument.defaultView.innerWidth,s.ownerDocument.defaultView.innerHeight,n).then(function(e){return"function"==typeof t.onrendered&&(_("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),t.onrendered(e)),e})}function i(e,t,n,o,r){return v(e,e,n,o,t,e.defaultView.pageXOffset,e.defaultView.pageYOffset).then(function(i){_("Document cloned");var s=x+r,d="["+s+"='"+r+"']";e.querySelector(d).removeAttribute(s);var u=i.contentWindow,c=u.document.querySelector(d);return("function"==typeof t.onclone?Promise.resolve(t.onclone(u.document)):Promise.resolve(!0)).then(function(){return a(c,i,t,n,o)})})}function a(e,t,n,o,r){var i=t.contentWindow,a=new p(i.document),l=new f(n,a),h=b(e),g="view"===n.type?o:u(i.document),y="view"===n.type?r:c(i.document),v=new n.renderer(g,y,l,n,document);return new m(e,v,a,l,n).ready.then(function(){_("Finished rendering");var o;return o="view"===n.type?d(v.canvas,{width:v.canvas.width,height:v.canvas.height,top:0,left:0,x:0,y:0}):e===i.document.body||e===i.document.documentElement||null!=n.canvas?v.canvas:d(v.canvas,{width:null!=n.width?n.width:h.width,height:null!=n.height?n.height:h.height,top:h.top,left:h.left,x:0,y:0}),s(t,n),o})}function s(e,t){t.removeContainer&&(e.parentNode.removeChild(e),_("Cleaned up container"))}function d(e,t){var n=document.createElement("canvas"),o=Math.min(e.width-1,Math.max(0,t.left)),r=Math.min(e.width,Math.max(1,t.left+t.width)),i=Math.min(e.height-1,Math.max(0,t.top)),a=Math.min(e.height,Math.max(1,t.top+t.height));n.width=t.width,n.height=t.height;var s=r-o,d=a-i;return _("Cropping canvas at:","left:",t.left,"top:",t.top,"width:",s,"height:",d),_("Resulting crop with width",t.width,"and height",t.height,"with x",o,"and y",i),n.getContext("2d").drawImage(e,o,i,s,d,t.x,t.y,s,d),n}function u(e){return Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth))}function c(e){return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function l(e){var t=document.createElement("a");return t.href=e,t.href=t.href,t}var p=t("./support"),h=t("./renderers/canvas"),f=t("./imageloader"),m=t("./nodeparser"),g=t("./nodecontainer"),_=t("./log"),y=t("./utils"),v=t("./clone"),w=t("./proxy").loadUrlDocument,b=y.getBounds,x="data-html2canvas-node",E=0;r.CanvasRenderer=h,r.NodeContainer=g,r.log=_,r.utils=y;var T="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return Promise.reject("No canvas support")}:r;n.exports=T,"function"==typeof e&&e.amd&&e("html2canvas",[],function(){return T})},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(e,t,n){function o(e){if(this.src=e,r("DummyImageContainer for",e),!this.promise||!this.image){r("Initiating DummyImageContainer"),o.prototype.image=new Image;var t=this.image;o.prototype.promise=new Promise(function(e,n){t.onload=e,t.onerror=n,t.src=i(),!0===t.complete&&e(t)})}}var r=e("./log"),i=e("./utils").smallImage;t.exports=o},{"./log":13,"./utils":26}],6:[function(e,t,n){function o(e,t){var n,o,i=document.createElement("div"),a=document.createElement("img"),s=document.createElement("span");i.style.visibility="hidden",i.style.fontFamily=e,i.style.fontSize=t,i.style.margin=0,i.style.padding=0,document.body.appendChild(i),a.src=r(),a.width=1,a.height=1,a.style.margin=0,a.style.padding=0,a.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=t,s.style.margin=0,s.style.padding=0,s.appendChild(document.createTextNode("Hidden Text")),i.appendChild(s),i.appendChild(a),n=a.offsetTop-s.offsetTop+1,i.removeChild(s),i.appendChild(document.createTextNode("Hidden Text")),i.style.lineHeight="normal",a.style.verticalAlign="super",o=a.offsetTop-i.offsetTop+1,document.body.removeChild(i),this.baseline=n,this.lineWidth=1,this.middle=o}var r=e("./utils").smallImage;t.exports=o},{"./utils":26}],7:[function(e,t,n){function o(){this.data={}}var r=e("./font");o.prototype.getMetrics=function(e,t){return void 0===this.data[e+"-"+t]&&(this.data[e+"-"+t]=new r(e,t)),this.data[e+"-"+t]},t.exports=o},{"./font":6}],8:[function(e,t,n){function o(t,n,o){this.image=null,this.src=t;var r=this,a=i(t);this.promise=(n?new Promise(function(e){"about:blank"===t.contentWindow.document.URL||null==t.contentWindow.document.documentElement?t.contentWindow.onload=t.onload=function(){e(t)}:e(t)}):this.proxyLoad(o.proxy,a,o)).then(function(t){return e("./core")(t.contentWindow.document.documentElement,{type:"view",width:t.width,height:t.height,proxy:o.proxy,javascriptEnabled:o.javascriptEnabled,removeContainer:o.removeContainer,allowTaint:o.allowTaint,imageTimeout:o.imageTimeout/2})}).then(function(e){return r.image=e})}var r=e("./utils"),i=r.getBounds,a=e("./proxy").loadUrlDocument;o.prototype.proxyLoad=function(e,t,n){var o=this.src;return a(o.src,e,o.ownerDocument,t.width,t.height,n)},t.exports=o},{"./core":4,"./proxy":16,"./utils":26}],9:[function(e,t,n){function o(e){this.src=e.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=Promise.resolve(!0)}o.TYPES={LINEAR:1,RADIAL:2},o.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i,t.exports=o},{}],10:[function(e,t,n){function o(e,t){this.src=e,this.image=new Image;var n=this;this.tainted=null,this.promise=new Promise(function(o,r){n.image.onload=o,n.image.onerror=r,t&&(n.image.crossOrigin="anonymous"),n.image.src=e,!0===n.image.complete&&o(n.image)})}t.exports=o},{}],11:[function(e,t,n){function o(e,t){this.link=null,this.options=e,this.support=t,this.origin=this.getOrigin(window.location.href)}var r=e("./log"),i=e("./imagecontainer"),a=e("./dummyimagecontainer"),s=e("./proxyimagecontainer"),d=e("./framecontainer"),u=e("./svgcontainer"),c=e("./svgnodecontainer"),l=e("./lineargradientcontainer"),p=e("./webkitgradientcontainer"),h=e("./utils").bind;o.prototype.findImages=function(e){var t=[];return e.reduce(function(e,t){switch(t.node.nodeName){case"IMG":return e.concat([{args:[t.node.src],method:"url"}]);case"svg":case"IFRAME":return e.concat([{args:[t.node],method:t.node.nodeName}])}return e},[]).forEach(this.addImage(t,this.loadImage),this),t},o.prototype.findBackgroundImage=function(e,t){return t.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(e,this.loadImage),this),e},o.prototype.addImage=function(e,t){return function(n){n.args.forEach(function(o){this.imageExists(e,o)||(e.splice(0,0,t.call(this,n)),r("Added image #"+e.length,"string"==typeof o?o.substring(0,100):o))},this)}},o.prototype.hasImageBackground=function(e){return"none"!==e.method},o.prototype.loadImage=function(e){if("url"===e.method){var t=e.args[0];return!this.isSVG(t)||this.support.svg||this.options.allowTaint?t.match(/data:image\/.*;base64,/i)?new i(t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(t)||!0===this.options.allowTaint||this.isSVG(t)?new i(t,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new i(t,!0):this.options.proxy?new s(t,this.options.proxy):new a(t):new u(t)}return"linear-gradient"===e.method?new l(e):"gradient"===e.method?new p(e):"svg"===e.method?new c(e.args[0],this.support.svg):"IFRAME"===e.method?new d(e.args[0],this.isSameOrigin(e.args[0].src),this.options):new a(e)},o.prototype.isSVG=function(e){return"svg"===e.substring(e.length-3).toLowerCase()||u.prototype.isInline(e)},o.prototype.imageExists=function(e,t){return e.some(function(e){return e.src===t})},o.prototype.isSameOrigin=function(e){return this.getOrigin(e)===this.origin},o.prototype.getOrigin=function(e){var t=this.link||(this.link=document.createElement("a"));return t.href=e,t.href=t.href,t.protocol+t.hostname+t.port},o.prototype.getPromise=function(e){return this.timeout(e,this.options.imageTimeout).catch(function(){return new a(e.src).promise.then(function(t){e.image=t})})},o.prototype.get=function(e){var t=null;return this.images.some(function(n){return(t=n).src===e})?t:null},o.prototype.fetch=function(e){return this.images=e.reduce(h(this.findBackgroundImage,this),this.findImages(e)),this.images.forEach(function(e,t){e.promise.then(function(){r("Succesfully loaded image #"+(t+1),e)},function(n){r("Failed loading image #"+(t+1),e,n)})}),this.ready=Promise.all(this.images.map(this.getPromise,this)),r("Finished searching images"),this},o.prototype.timeout=function(e,t){var n,o=Promise.race([e.promise,new Promise(function(o,i){n=setTimeout(function(){r("Timed out loading image",e),i(e)},t)})]).then(function(e){return clearTimeout(n),e});return o.catch(function(){clearTimeout(n)}),o},t.exports=o},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(e,t,n){function o(e){r.apply(this,arguments),this.type=r.TYPES.LINEAR;var t=o.REGEXP_DIRECTION.test(e.args[0])||!r.REGEXP_COLORSTOP.test(e.args[0]);t?e.args[0].split(/\s+/).reverse().forEach(function(e,t){switch(e){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var n=this.y0,o=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=o,this.y1=n;break;case"center":break;default:var r=.01*parseFloat(e,10);if(isNaN(r))break;0===t?(this.y0=r,this.y1=1-this.y0):(this.x0=r,this.x1=1-this.x0)}},this):(this.y0=0,this.y1=1),this.colorStops=e.args.slice(t?1:0).map(function(e){var t=e.match(r.REGEXP_COLORSTOP),n=+t[2],o=0===n?"%":t[3];return{color:new i(t[1]),stop:"%"===o?n/100:null}}),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(e,t){null===e.stop&&this.colorStops.slice(t).some(function(n,o){return null!==n.stop&&(e.stop=(n.stop-this.colorStops[t-1].stop)/(o+1)+this.colorStops[t-1].stop,!0)},this)},this)}var r=e("./gradientcontainer"),i=e("./color");o.prototype=Object.create(r.prototype),o.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i,t.exports=o},{"./color":3,"./gradientcontainer":9}],13:[function(e,t,n){var o=function(){o.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-o.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};o.options={logging:!1},t.exports=o},{}],14:[function(e,t,n){function o(e,t){this.node=e,this.parent=t,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function r(e){var t=e.options[e.selectedIndex||0];return t?t.text||"":""}function i(e){if(e&&"matrix"===e[1])return e[2].split(",").map(function(e){return parseFloat(e.trim())});if(e&&"matrix3d"===e[1]){var t=e[2].split(",").map(function(e){return parseFloat(e.trim())});return[t[0],t[1],t[4],t[5],t[12],t[13]]}}function a(e){return-1!==e.toString().indexOf("%")}function s(e){return e.replace("px","")}function d(e){return parseFloat(e)}var u=e("./color"),c=e("./utils"),l=c.getBounds,p=c.parseBackgrounds,h=c.offsetBounds;o.prototype.cloneTo=function(e){e.visible=this.visible,e.borders=this.borders,e.bounds=this.bounds,e.clip=this.clip,e.backgroundClip=this.backgroundClip,e.computedStyles=this.computedStyles,e.styles=this.styles,e.backgroundImages=this.backgroundImages,e.opacity=this.opacity},o.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},o.prototype.assignStack=function(e){this.stack=e,e.children.push(this)},o.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},o.prototype.css=function(e){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[e]||(this.styles[e]=this.computedStyles[e])},o.prototype.prefixedCss=function(e){var t=["webkit","moz","ms","o"],n=this.css(e);return void 0===n&&t.some(function(t){return void 0!==(n=this.css(t+e.substr(0,1).toUpperCase()+e.substr(1)))},this),void 0===n?null:n},o.prototype.computedStyle=function(e){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,e)},o.prototype.cssInt=function(e){var t=parseInt(this.css(e),10);return isNaN(t)?0:t},o.prototype.color=function(e){return this.colors[e]||(this.colors[e]=new u(this.css(e)))},o.prototype.cssFloat=function(e){var t=parseFloat(this.css(e));return isNaN(t)?0:t},o.prototype.fontWeight=function(){var e=this.css("fontWeight");switch(parseInt(e,10)){case 401:e="bold";break;case 400:e="normal"}return e},o.prototype.parseClip=function(){var e=this.css("clip").match(this.CLIP);return e?{top:parseInt(e[1],10),right:parseInt(e[2],10),bottom:parseInt(e[3],10),left:parseInt(e[4],10)}:null},o.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=p(this.css("backgroundImage")))},o.prototype.cssList=function(e,t){var n=(this.css(e)||"").split(",");return n=n[t||0]||n[0]||"auto",n=n.trim().split(" "),1===n.length&&(n=[n[0],a(n[0])?"auto":n[0]]),n},o.prototype.parseBackgroundSize=function(e,t,n){var o,r,i=this.cssList("backgroundSize",n);if(a(i[0]))o=e.width*parseFloat(i[0])/100;else{if(/contain|cover/.test(i[0])){var s=e.width/e.height,d=t.width/t.height;return s<d^"contain"===i[0]?{width:e.height*d,height:e.height}:{width:e.width,height:e.width/d}}o=parseInt(i[0],10)}return r="auto"===i[0]&&"auto"===i[1]?t.height:"auto"===i[1]?o/t.width*t.height:a(i[1])?e.height*parseFloat(i[1])/100:parseInt(i[1],10),"auto"===i[0]&&(o=r/t.height*t.width),{width:o,height:r}},o.prototype.parseBackgroundPosition=function(e,t,n,o){var r,i,s=this.cssList("backgroundPosition",n);return r=a(s[0])?(e.width-(o||t).width)*(parseFloat(s[0])/100):parseInt(s[0],10),i="auto"===s[1]?r/t.width*t.height:a(s[1])?(e.height-(o||t).height)*parseFloat(s[1])/100:parseInt(s[1],10),"auto"===s[0]&&(r=i/t.height*t.width),{left:r,top:i}},o.prototype.parseBackgroundRepeat=function(e){return this.cssList("backgroundRepeat",e)[0]},o.prototype.parseTextShadows=function(){var e=this.css("textShadow"),t=[];if(e&&"none"!==e)for(var n=e.match(this.TEXT_SHADOW_PROPERTY),o=0;n&&o<n.length;o++){var r=n[o].match(this.TEXT_SHADOW_VALUES);t.push({color:new u(r[0]),offsetX:r[1]?parseFloat(r[1].replace("px","")):0,offsetY:r[2]?parseFloat(r[2].replace("px","")):0,blur:r[3]?r[3].replace("px",""):0})}return t},o.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var e=this.parseBounds(),t=this.prefixedCss("transformOrigin").split(" ").map(s).map(d);t[0]+=e.left,t[1]+=e.top,this.transformData={origin:t,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData},o.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var e=this.prefixedCss("transform"),t=e?i(e.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=t||[1,0,0,1,0,0]}return this.transformMatrix},o.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?h(this.node):l(this.node))},o.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},o.prototype.getValue=function(){var e=this.node.value||"";return"SELECT"===this.node.tagName?e=r(this.node):"password"===this.node.type&&(e=Array(e.length+1).join("•")),0===e.length?this.node.placeholder||"":e},o.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,o.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,o.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,o.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,t.exports=o},{"./color":3,"./utils":26}],15:[function(e,t,n){function o(e,t,n,o,r){H("Starting NodeParser"),this.renderer=t,this.options=r,this.range=null,this.support=n,this.renderQueue=[],this.stack=new X(!0,1,e.ownerDocument,null);var i=new G(e,null);if(r.background&&t.rectangle(0,0,t.width,t.height,new z(r.background)),e===e.ownerDocument.documentElement){var a=new G(i.color("backgroundColor").isTransparent()?e.ownerDocument.body:e.ownerDocument.documentElement,null);t.rectangle(0,0,t.width,t.height,a.color("backgroundColor"))}i.visibile=i.isElementVisible(),this.createPseudoHideStyles(e.ownerDocument),this.disableAnimations(e.ownerDocument),this.nodes=L([i].concat(this.getChildren(i)).filter(function(e){return e.visible=e.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new U,H("Fetched nodes, total:",this.nodes.length),H("Calculate overflow clips"),this.calculateOverflowClips(),H("Start fetching images"),this.images=o.fetch(this.nodes.filter(S)),this.ready=this.images.ready.then(Q(function(){return H("Images loaded, starting parsing"),H("Creating stacking contexts"),this.createStackingContexts(),H("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),H("Render queue created with "+this.renderQueue.length+" items"),new Promise(Q(function(e){r.async?"function"==typeof r.async?r.async.call(this,this.renderQueue,e):this.renderQueue.length>0?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,e)):e():(this.renderQueue.forEach(this.paint,this),e())},this))},this))}function r(e){return e.parent&&e.parent.clip.length}function i(e){return e.replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-","")})}function a(){}function s(e,t,n,o){return e.map(function(r,i){if(r.width>0){var a=t.left,s=t.top,d=t.width,u=t.height-e[2].width;switch(i){case 0:u=e[0].width,r.args=l({c1:[a,s],c2:[a+d,s],c3:[a+d-e[1].width,s+u],c4:[a+e[3].width,s+u]},o[0],o[1],n.topLeftOuter,n.topLeftInner,n.topRightOuter,n.topRightInner);break;case 1:a=t.left+t.width-e[1].width,d=e[1].width,r.args=l({c1:[a+d,s],c2:[a+d,s+u+e[2].width],c3:[a,s+u],c4:[a,s+e[0].width]},o[1],o[2],n.topRightOuter,n.topRightInner,n.bottomRightOuter,n.bottomRightInner);break;case 2:s=s+t.height-e[2].width,u=e[2].width,r.args=l({c1:[a+d,s+u],c2:[a,s+u],c3:[a+e[3].width,s],c4:[a+d-e[3].width,s]},o[2],o[3],n.bottomRightOuter,n.bottomRightInner,n.bottomLeftOuter,n.bottomLeftInner);break;case 3:d=e[3].width,r.args=l({c1:[a,s+u+e[2].width],c2:[a,s],c3:[a+d,s+e[0].width],c4:[a+d,s+u]},o[3],o[0],n.bottomLeftOuter,n.bottomLeftInner,n.topLeftOuter,n.topLeftInner)}}return r})}function d(e,t,n,o){var r=(Math.sqrt(2)-1)/3*4,i=n*r,a=o*r,s=e+n,d=t+o;return{topLeft:c({x:e,y:d},{x:e,y:d-a},{x:s-i,y:t},{x:s,y:t}),topRight:c({x:e,y:t},{x:e+i,y:t},{x:s,y:d-a},{x:s,y:d}),bottomRight:c({x:s,y:t},{x:s,y:t+a},{x:e+i,y:d},{x:e,y:d}),bottomLeft:c({x:s,y:d},{x:s-i,y:d},{x:e,y:t+a},{x:e,y:t})}}function u(e,t,n){var o=e.left,r=e.top,i=e.width,a=e.height,s=t[0][0]<i/2?t[0][0]:i/2,u=t[0][1]<a/2?t[0][1]:a/2,c=t[1][0]<i/2?t[1][0]:i/2,l=t[1][1]<a/2?t[1][1]:a/2,p=t[2][0]<i/2?t[2][0]:i/2,h=t[2][1]<a/2?t[2][1]:a/2,f=t[3][0]<i/2?t[3][0]:i/2,m=t[3][1]<a/2?t[3][1]:a/2,g=i-c,_=a-h,y=i-p,v=a-m;return{topLeftOuter:d(o,r,s,u).topLeft.subdivide(.5),topLeftInner:d(o+n[3].width,r+n[0].width,Math.max(0,s-n[3].width),Math.max(0,u-n[0].width)).topLeft.subdivide(.5),topRightOuter:d(o+g,r,c,l).topRight.subdivide(.5),topRightInner:d(o+Math.min(g,i+n[3].width),r+n[0].width,g>i+n[3].width?0:c-n[3].width,l-n[0].width).topRight.subdivide(.5),bottomRightOuter:d(o+y,r+_,p,h).bottomRight.subdivide(.5),bottomRightInner:d(o+Math.min(y,i-n[3].width),r+Math.min(_,a+n[0].width),Math.max(0,p-n[1].width),h-n[2].width).bottomRight.subdivide(.5),bottomLeftOuter:d(o,r+v,f,m).bottomLeft.subdivide(.5),bottomLeftInner:d(o+n[3].width,r+v,Math.max(0,f-n[3].width),m-n[2].width).bottomLeft.subdivide(.5)}}function c(e,t,n,o){var r=function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}};return{start:e,startControl:t,endControl:n,end:o,subdivide:function(i){var a=r(e,t,i),s=r(t,n,i),d=r(n,o,i),u=r(a,s,i),l=r(s,d,i),p=r(u,l,i);return[c(e,a,u,p),c(p,l,d,o)]},curveTo:function(e){e.push(["bezierCurve",t.x,t.y,n.x,n.y,o.x,o.y])},curveToReversed:function(o){o.push(["bezierCurve",n.x,n.y,t.x,t.y,e.x,e.y])}}}function l(e,t,n,o,r,i,a){var s=[];return t[0]>0||t[1]>0?(s.push(["line",o[1].start.x,o[1].start.y]),o[1].curveTo(s)):s.push(["line",e.c1[0],e.c1[1]]),n[0]>0||n[1]>0?(s.push(["line",i[0].start.x,i[0].start.y]),i[0].curveTo(s),s.push(["line",a[0].end.x,a[0].end.y]),a[0].curveToReversed(s)):(s.push(["line",e.c2[0],e.c2[1]]),s.push(["line",e.c3[0],e.c3[1]])),t[0]>0||t[1]>0?(s.push(["line",r[1].end.x,r[1].end.y]),r[1].curveToReversed(s)):s.push(["line",e.c4[0],e.c4[1]]),s}function p(e,t,n,o,r,i,a){t[0]>0||t[1]>0?(e.push(["line",o[0].start.x,o[0].start.y]),o[0].curveTo(e),o[1].curveTo(e)):e.push(["line",i,a]),(n[0]>0||n[1]>0)&&e.push(["line",r[0].start.x,r[0].start.y])}function h(e){return e.cssInt("zIndex")<0}function f(e){return e.cssInt("zIndex")>0}function m(e){return 0===e.cssInt("zIndex")}function g(e){return-1!==["inline","inline-block","inline-table"].indexOf(e.css("display"))}function _(e){return e instanceof X}function y(e){return e.node.data.trim().length>0}function v(e){return/^(normal|none|0px)$/.test(e.parent.css("letterSpacing"))}function w(e){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(t){var n=e.css("border"+t+"Radius"),o=n.split(" ");return o.length<=1&&(o[1]=o[0]),o.map(B)})}function b(e){return e.nodeType===Node.TEXT_NODE||e.nodeType===Node.ELEMENT_NODE}function x(e){return"auto"!==(-1!==["absolute","relative","fixed"].indexOf(e.css("position"))?e.css("zIndex"):"auto")}function E(e){return"static"!==e.css("position")}function T(e){return"none"!==e.css("float")}function A(e){return-1!==["inline-block","inline-table"].indexOf(e.css("display"))}function k(e){var t=this;return function(){return!e.apply(t,arguments)}}function S(e){return e.node.nodeType===Node.ELEMENT_NODE}function I(e){return!0===e.isPseudoElement}function O(e){return e.node.nodeType===Node.TEXT_NODE}function C(e){return function(t,n){return t.cssInt("zIndex")+e.indexOf(t)/e.length-(n.cssInt("zIndex")+e.indexOf(n)/e.length)}}function M(e){return e.getOpacity()<1}function B(e){return parseInt(e,10)}function P(e){return e.width}function R(e){return e.node.nodeType!==Node.ELEMENT_NODE||-1===["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(e.node.nodeName)}function L(e){return[].concat.apply([],e)}function D(e){var t=e.substr(0,1);return t===e.substr(e.length-1)&&t.match(/'|"/)?e.substr(1,e.length-2):e}function N(e){for(var t,n=[],o=0,r=!1;e.length;)F(e[o])===r?(t=e.splice(0,o),t.length&&n.push(W.ucs2.encode(t)),r=!r,o=0):o++,o>=e.length&&(t=e.splice(0,o),t.length&&n.push(W.ucs2.encode(t)));return n}function F(e){return-1!==[32,13,10,9,45].indexOf(e)}function j(e){return/[^\u0000-\u00ff]/.test(e)}var H=e("./log"),W=e("punycode"),G=e("./nodecontainer"),q=e("./textcontainer"),V=e("./pseudoelementcontainer"),U=e("./fontmetrics"),z=e("./color"),X=e("./stackingcontext"),$=e("./utils"),Q=$.bind,Y=$.getBounds,K=$.parseBackgrounds,J=$.offsetBounds;o.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(e){if(S(e)){I(e)&&e.appendToDOM(),e.borders=this.parseBorders(e);var t="hidden"===e.css("overflow")?[e.borders.clip]:[],n=e.parseClip();n&&-1!==["absolute","fixed"].indexOf(e.css("position"))&&t.push([["rect",e.bounds.left+n.left,e.bounds.top+n.top,n.right-n.left,n.bottom-n.top]]),e.clip=r(e)?e.parent.clip.concat(t):t,e.backgroundClip="hidden"!==e.css("overflow")?e.clip.concat([e.borders.clip]):e.clip,I(e)&&e.cleanDOM()}else O(e)&&(e.clip=r(e)?e.parent.clip:[]);I(e)||(e.bounds=null)},this)},o.prototype.asyncRenderer=function(e,t,n){n=n||Date.now(),this.paint(e[this.renderIndex++]),e.length===this.renderIndex?t():n+20>Date.now()?this.asyncRenderer(e,t,n):setTimeout(Q(function(){this.asyncRenderer(e,t)},this),0)},o.prototype.createPseudoHideStyles=function(e){this.createStyles(e,"."+V.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+V.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},o.prototype.disableAnimations=function(e){this.createStyles(e,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},o.prototype.createStyles=function(e,t){var n=e.createElement("style");n.innerHTML=t,e.body.appendChild(n)},o.prototype.getPseudoElements=function(e){var t=[[e]];if(e.node.nodeType===Node.ELEMENT_NODE){var n=this.getPseudoElement(e,":before"),o=this.getPseudoElement(e,":after");n&&t.push(n),o&&t.push(o)}return L(t)},o.prototype.getPseudoElement=function(e,t){var n=e.computedStyle(t);if(!n||!n.content||"none"===n.content||"-moz-alt-content"===n.content||"none"===n.display)return null;for(var o=D(n.content),r="url"===o.substr(0,3),a=document.createElement(r?"img":"html2canvaspseudoelement"),s=new V(a,e,t),d=n.length-1;d>=0;d--){var u=i(n.item(d));a.style[u]=n[u]}if(a.className=V.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+V.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,r)return a.src=K(o)[0].args[0],[s];var c=document.createTextNode(o);return a.appendChild(c),[s,new q(c,s)]},o.prototype.getChildren=function(e){return L([].filter.call(e.node.childNodes,b).map(function(t){var n=[t.nodeType===Node.TEXT_NODE?new q(t,e):new G(t,e)].filter(R);return t.nodeType===Node.ELEMENT_NODE&&n.length&&"TEXTAREA"!==t.tagName?n[0].isElementVisible()?n.concat(this.getChildren(n[0])):[]:n},this))},o.prototype.newStackingContext=function(e,t){var n=new X(t,e.getOpacity(),e.node,e.parent);e.cloneTo(n),(t?n.getParentStack(this):n.parent.stack).contexts.push(n),e.stack=n},o.prototype.createStackingContexts=function(){this.nodes.forEach(function(e){S(e)&&(this.isRootElement(e)||M(e)||x(e)||this.isBodyWithTransparentRoot(e)||e.hasTransform())?this.newStackingContext(e,!0):S(e)&&(E(e)&&m(e)||A(e)||T(e))?this.newStackingContext(e,!1):e.assignStack(e.parent.stack)},this)},o.prototype.isBodyWithTransparentRoot=function(e){return"BODY"===e.node.nodeName&&e.parent.color("backgroundColor").isTransparent()},o.prototype.isRootElement=function(e){return null===e.parent},o.prototype.sortStackingContexts=function(e){e.contexts.sort(C(e.contexts.slice(0))),e.contexts.forEach(this.sortStackingContexts,this)},o.prototype.parseTextBounds=function(e){return function(t,n,o){if("none"!==e.parent.css("textDecoration").substr(0,4)||0!==t.trim().length){if(this.support.rangeBounds&&!e.parent.hasTransform()){var r=o.slice(0,n).join("").length;return this.getRangeBounds(e.node,r,t.length)}if(e.node&&"string"==typeof e.node.data){var i=e.node.splitText(t.length),a=this.getWrapperBounds(e.node,e.parent.hasTransform());return e.node=i,a}}else this.support.rangeBounds&&!e.parent.hasTransform()||(e.node=e.node.splitText(t.length));return{}}},o.prototype.getWrapperBounds=function(e,t){var n=e.ownerDocument.createElement("html2canvaswrapper"),o=e.parentNode,r=e.cloneNode(!0);n.appendChild(e.cloneNode(!0)),o.replaceChild(n,e);var i=t?J(n):Y(n);return o.replaceChild(r,n),i},o.prototype.getRangeBounds=function(e,t,n){var o=this.range||(this.range=e.ownerDocument.createRange());return o.setStart(e,t),o.setEnd(e,t+n),o.getBoundingClientRect()},o.prototype.parse=function(e){var t=e.contexts.filter(h),n=e.children.filter(S),o=n.filter(k(T)),r=o.filter(k(E)).filter(k(g)),i=n.filter(k(E)).filter(T),s=o.filter(k(E)).filter(g),d=e.contexts.concat(o.filter(E)).filter(m),u=e.children.filter(O).filter(y),c=e.contexts.filter(f);t.concat(r).concat(i).concat(s).concat(d).concat(u).concat(c).forEach(function(e){this.renderQueue.push(e),_(e)&&(this.parse(e),this.renderQueue.push(new a))},this)},o.prototype.paint=function(e){try{e instanceof a?this.renderer.ctx.restore():O(e)?(I(e.parent)&&e.parent.appendToDOM(),this.paintText(e),I(e.parent)&&e.parent.cleanDOM()):this.paintNode(e)}catch(e){if(H(e),this.options.strict)throw e}},o.prototype.paintNode=function(e){_(e)&&(this.renderer.setOpacity(e.opacity),this.renderer.ctx.save(),e.hasTransform()&&this.renderer.setTransform(e.parseTransform())),"INPUT"===e.node.nodeName&&"checkbox"===e.node.type?this.paintCheckbox(e):"INPUT"===e.node.nodeName&&"radio"===e.node.type?this.paintRadio(e):this.paintElement(e)},o.prototype.paintElement=function(e){var t=e.parseBounds();this.renderer.clip(e.backgroundClip,function(){this.renderer.renderBackground(e,t,e.borders.borders.map(P))},this),this.renderer.clip(e.clip,function(){this.renderer.renderBorders(e.borders.borders)},this),this.renderer.clip(e.backgroundClip,function(){switch(e.node.nodeName){case"svg":case"IFRAME":var n=this.images.get(e.node);n?this.renderer.renderImage(e,t,e.borders,n):H("Error loading <"+e.node.nodeName+">",e.node);break;case"IMG":var o=this.images.get(e.node.src);o?this.renderer.renderImage(e,t,e.borders,o):H("Error loading <img>",e.node.src);break;case"CANVAS":this.renderer.renderImage(e,t,e.borders,{image:e.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(e)}},this)},o.prototype.paintCheckbox=function(e){var t=e.parseBounds(),n=Math.min(t.width,t.height),o={width:n-1,height:n-1,top:t.top,left:t.left},r=[3,3],i=[r,r,r,r],a=[1,1,1,1].map(function(e){return{color:new z("#A5A5A5"),width:e}}),d=u(o,i,a);this.renderer.clip(e.backgroundClip,function(){this.renderer.rectangle(o.left+1,o.top+1,o.width-2,o.height-2,new z("#DEDEDE")),this.renderer.renderBorders(s(a,o,d,i)),e.node.checked&&(this.renderer.font(new z("#424242"),"normal","normal","bold",n-3+"px","arial"),this.renderer.text("✔",o.left+n/6,o.top+n-1))},this)},o.prototype.paintRadio=function(e){var t=e.parseBounds(),n=Math.min(t.width,t.height)-2;this.renderer.clip(e.backgroundClip,function(){this.renderer.circleStroke(t.left+1,t.top+1,n,new z("#DEDEDE"),1,new z("#A5A5A5")),e.node.checked&&this.renderer.circle(Math.ceil(t.left+n/4)+1,Math.ceil(t.top+n/4)+1,Math.floor(n/2),new z("#424242"))},this)},o.prototype.paintFormValue=function(e){var t=e.getValue();if(t.length>0){var n=e.node.ownerDocument,o=n.createElement("html2canvaswrapper");["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"].forEach(function(t){try{o.style[t]=e.css(t)}catch(e){H("html2canvas: Parse: Exception caught in renderFormValue: "+e.message)}});var r=e.parseBounds();o.style.position="fixed",o.style.left=r.left+"px",o.style.top=r.top+"px",o.textContent=t,n.body.appendChild(o),this.paintText(new q(o.firstChild,e)),n.body.removeChild(o)}},o.prototype.paintText=function(e){e.applyTextTransform();var t=W.ucs2.decode(e.node.data),n=this.options.letterRendering&&!v(e)||j(e.node.data)?t.map(function(e){return W.ucs2.encode([e])}):N(t),o=e.parent.fontWeight(),r=e.parent.css("fontSize"),i=e.parent.css("fontFamily"),a=e.parent.parseTextShadows();this.renderer.font(e.parent.color("color"),e.parent.css("fontStyle"),e.parent.css("fontVariant"),o,r,i),a.length?this.renderer.fontShadow(a[0].color,a[0].offsetX,a[0].offsetY,a[0].blur):this.renderer.clearShadow(),this.renderer.clip(e.parent.clip,function(){n.map(this.parseTextBounds(e),this).forEach(function(t,o){t&&(this.renderer.text(n[o],t.left,t.bottom),this.renderTextDecoration(e.parent,t,this.fontMetrics.getMetrics(i,r)))},this)},this)},o.prototype.renderTextDecoration=function(e,t,n){switch(e.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(t.left,Math.round(t.top+n.baseline+n.lineWidth),t.width,1,e.color("color"));break;case"overline":this.renderer.rectangle(t.left,Math.round(t.top),t.width,1,e.color("color"));break;case"line-through":this.renderer.rectangle(t.left,Math.ceil(t.top+n.middle+n.lineWidth),t.width,1,e.color("color"))}};var Z={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};o.prototype.parseBorders=function(e){var t=e.parseBounds(),n=w(e),o=["Top","Right","Bottom","Left"].map(function(t,n){var o=e.css("border"+t+"Style"),r=e.color("border"+t+"Color");"inset"===o&&r.isBlack()&&(r=new z([255,255,255,r.a]));var i=Z[o]?Z[o][n]:null;return{width:e.cssInt("border"+t+"Width"),color:i?r[i[0]](i[1]):r,args:null}}),r=u(t,n,o);return{clip:this.parseBackgroundClip(e,r,o,n,t),borders:s(o,t,r,n)}},o.prototype.parseBackgroundClip=function(e,t,n,o,r){var i=e.css("backgroundClip"),a=[];switch(i){case"content-box":case"padding-box":p(a,o[0],o[1],t.topLeftInner,t.topRightInner,r.left+n[3].width,r.top+n[0].width),p(a,o[1],o[2],t.topRightInner,t.bottomRightInner,r.left+r.width-n[1].width,r.top+n[0].width),p(a,o[2],o[3],t.bottomRightInner,t.bottomLeftInner,r.left+r.width-n[1].width,r.top+r.height-n[2].width),p(a,o[3],o[0],t.bottomLeftInner,t.topLeftInner,r.left+n[3].width,r.top+r.height-n[2].width);break;default:p(a,o[0],o[1],t.topLeftOuter,t.topRightOuter,r.left,r.top),p(a,o[1],o[2],t.topRightOuter,t.bottomRightOuter,r.left+r.width,r.top),p(a,o[2],o[3],t.bottomRightOuter,t.bottomLeftOuter,r.left+r.width,r.top+r.height),p(a,o[3],o[0],t.bottomLeftOuter,t.topLeftOuter,r.left,r.top+r.height)}return a},t.exports=o},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(e,t,n){function o(e,t,n){var o="withCredentials"in new XMLHttpRequest;if(!t)return Promise.reject("No proxy configured");var r=a(o),d=s(t,e,r);return o?c(d):i(n,d,r).then(function(e){return f(e.content)})}function r(e,t,n){var o="crossOrigin"in new Image,r=a(o),d=s(t,e,r);return o?Promise.resolve(d):i(n,d,r).then(function(e){return"data:"+e.type+";base64,"+e.content})}function i(e,t,n){return new Promise(function(o,r){var i=e.createElement("script"),a=function(){delete window.html2canvas.proxy[n],e.body.removeChild(i)};window.html2canvas.proxy[n]=function(e){a(),o(e)},i.src=t,i.onerror=function(e){a(),r(e)},e.body.appendChild(i)})}function a(e){return e?"":"html2canvas_"+Date.now()+"_"+ ++m+"_"+Math.round(1e5*Math.random())}function s(e,t,n){return e+"?url="+encodeURIComponent(t)+(n.length?"&callback=html2canvas.proxy."+n:"")}function d(e){return function(t){var n,o=new DOMParser;try{n=o.parseFromString(t,"text/html")}catch(e){p("DOMParser not supported, falling back to createHTMLDocument"),n=document.implementation.createHTMLDocument("");try{n.open(),n.write(t),n.close()}catch(e){p("createHTMLDocument write not supported, falling back to document.body.innerHTML"),n.body.innerHTML=t}}var r=n.querySelector("base");if(!r||!r.href.host){var i=n.createElement("base");i.href=e,n.head.insertBefore(i,n.head.firstChild)}return n}}function u(e,t,n,r,i,a){return new o(e,t,window.document).then(d(e)).then(function(e){return h(e,n,r,i,a,0,0)})}var c=e("./xhr"),l=e("./utils"),p=e("./log"),h=e("./clone"),f=l.decode64,m=0;n.Proxy=o,n.ProxyURL=r,n.loadUrlDocument=u},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(e,t,n){function o(e,t){var n=document.createElement("a");n.href=e,e=n.href,this.src=e,this.image=new Image;var o=this;this.promise=new Promise(function(n,i){o.image.crossOrigin="Anonymous",o.image.onload=n,o.image.onerror=i,new r(e,t,document).then(function(e){o.image.src=e}).catch(i)})}var r=e("./proxy").ProxyURL;t.exports=o},{"./proxy":16}],18:[function(e,t,n){function o(e,t,n){r.call(this,e,t),this.isPseudoElement=!0,this.before=":before"===n}var r=e("./nodecontainer");o.prototype.cloneTo=function(e){o.prototype.cloneTo.call(this,e),e.isPseudoElement=!0,e.before=this.before},o.prototype=Object.create(r.prototype),o.prototype.appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},o.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},o.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},o.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",o.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",t.exports=o},{"./nodecontainer":14}],19:[function(e,t,n){function o(e,t,n,o,r){this.width=e,this.height=t,this.images=n,this.options=o,this.document=r}var r=e("./log");o.prototype.renderImage=function(e,t,n,o){var r=e.cssInt("paddingLeft"),i=e.cssInt("paddingTop"),a=e.cssInt("paddingRight"),s=e.cssInt("paddingBottom"),d=n.borders,u=t.width-(d[1].width+d[3].width+r+a),c=t.height-(d[0].width+d[2].width+i+s);this.drawImage(o,0,0,o.image.width||u,o.image.height||c,t.left+r+d[3].width,t.top+i+d[0].width,u,c)},o.prototype.renderBackground=function(e,t,n){t.height>0&&t.width>0&&(this.renderBackgroundColor(e,t),this.renderBackgroundImage(e,t,n))},o.prototype.renderBackgroundColor=function(e,t){var n=e.color("backgroundColor");n.isTransparent()||this.rectangle(t.left,t.top,t.width,t.height,n)},o.prototype.renderBorders=function(e){e.forEach(this.renderBorder,this)},o.prototype.renderBorder=function(e){e.color.isTransparent()||null===e.args||this.drawShape(e.args,e.color)},o.prototype.renderBackgroundImage=function(e,t,n){e.parseBackgroundImages().reverse().forEach(function(o,i,a){switch(o.method){case"url":var s=this.images.get(o.args[0]);s?this.renderBackgroundRepeating(e,t,s,a.length-(i+1),n):r("Error loading background-image",o.args[0]);break;case"linear-gradient":case"gradient":var d=this.images.get(o.value);d?this.renderBackgroundGradient(d,t,n):r("Error loading background-image",o.args[0]);break;case"none":break;default:r("Unknown background-image type",o.args[0])}},this)},o.prototype.renderBackgroundRepeating=function(e,t,n,o,r){var i=e.parseBackgroundSize(t,n.image,o),a=e.parseBackgroundPosition(t,n.image,o,i);switch(e.parseBackgroundRepeat(o)){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(n,a,i,t,t.left+r[3],t.top+a.top+r[0],99999,i.height,r);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(n,a,i,t,t.left+a.left+r[3],t.top+r[0],i.width,99999,r);break;case"no-repeat":this.backgroundRepeatShape(n,a,i,t,t.left+a.left+r[3],t.top+a.top+r[0],i.width,i.height,r);break;default:this.renderBackgroundRepeat(n,a,i,{top:t.top,left:t.left},r[3],r[0])}},t.exports=o},{"./log":13}],20:[function(e,t,n){function o(e,t){i.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=e,this.canvas.height=t),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},s("Initialized CanvasRenderer with size",e,"x",t)}function r(e){return e.length>0}var i=e("../renderer"),a=e("../lineargradientcontainer"),s=e("../log");o.prototype=Object.create(i.prototype),o.prototype.setFillStyle=function(e){return this.ctx.fillStyle="object"==typeof e&&e.isColor?e.toString():e,this.ctx},o.prototype.rectangle=function(e,t,n,o,r){this.setFillStyle(r).fillRect(e,t,n,o)},o.prototype.circle=function(e,t,n,o){this.setFillStyle(o),this.ctx.beginPath(),this.ctx.arc(e+n/2,t+n/2,n/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},o.prototype.circleStroke=function(e,t,n,o,r,i){this.circle(e,t,n,o),this.ctx.strokeStyle=i.toString(),this.ctx.stroke()},o.prototype.drawShape=function(e,t){this.shape(e),this.setFillStyle(t).fill()},o.prototype.taints=function(e){if(null===e.tainted){this.taintCtx.drawImage(e.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),e.tainted=!1}catch(t){this.taintCtx=document.createElement("canvas").getContext("2d"),e.tainted=!0}}return e.tainted},o.prototype.drawImage=function(e,t,n,o,r,i,a,s,d){this.taints(e)&&!this.options.allowTaint||this.ctx.drawImage(e.image,t,n,o,r,i,a,s,d)},o.prototype.clip=function(e,t,n){this.ctx.save(),e.filter(r).forEach(function(e){this.shape(e).clip()},this),t.call(n),this.ctx.restore()},o.prototype.shape=function(e){return this.ctx.beginPath(),e.forEach(function(e,t){"rect"===e[0]?this.ctx.rect.apply(this.ctx,e.slice(1)):this.ctx[0===t?"moveTo":e[0]+"To"].apply(this.ctx,e.slice(1))},this),this.ctx.closePath(),this.ctx},o.prototype.font=function(e,t,n,o,r,i){this.setFillStyle(e).font=[t,n,o,r,i].join(" ").split(",")[0]},o.prototype.fontShadow=function(e,t,n,o){this.setVariable("shadowColor",e.toString()).setVariable("shadowOffsetY",t).setVariable("shadowOffsetX",n).setVariable("shadowBlur",o)},o.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},o.prototype.setOpacity=function(e){this.ctx.globalAlpha=e},o.prototype.setTransform=function(e){this.ctx.translate(e.origin[0],e.origin[1]),this.ctx.transform.apply(this.ctx,e.matrix),this.ctx.translate(-e.origin[0],-e.origin[1])},o.prototype.setVariable=function(e,t){return this.variables[e]!==t&&(this.variables[e]=this.ctx[e]=t),this},o.prototype.text=function(e,t,n){this.ctx.fillText(e,t,n)},o.prototype.backgroundRepeatShape=function(e,t,n,o,r,i,a,s,d){var u=[["line",Math.round(r),Math.round(i)],["line",Math.round(r+a),Math.round(i)],["line",Math.round(r+a),Math.round(s+i)],["line",Math.round(r),Math.round(s+i)]];this.clip([u],function(){this.renderBackgroundRepeat(e,t,n,o,d[3],d[0])},this)},o.prototype.renderBackgroundRepeat=function(e,t,n,o,r,i){var a=Math.round(o.left+t.left+r),s=Math.round(o.top+t.top+i);this.setFillStyle(this.ctx.createPattern(this.resizeImage(e,n),"repeat")),this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},o.prototype.renderBackgroundGradient=function(e,t){if(e instanceof a){var n=this.ctx.createLinearGradient(t.left+t.width*e.x0,t.top+t.height*e.y0,t.left+t.width*e.x1,t.top+t.height*e.y1);e.colorStops.forEach(function(e){n.addColorStop(e.stop,e.color.toString())}),this.rectangle(t.left,t.top,t.width,t.height,n)}},o.prototype.resizeImage=function(e,t){var n=e.image;if(n.width===t.width&&n.height===t.height)return n;var o,r=document.createElement("canvas");return r.width=t.width,r.height=t.height,o=r.getContext("2d"),o.drawImage(n,0,0,n.width,n.height,0,0,t.width,t.height),r},t.exports=o},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(e,t,n){function o(e,t,n,o){r.call(this,n,o),this.ownStacking=e,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*t}var r=e("./nodecontainer");o.prototype=Object.create(r.prototype),o.prototype.getParentStack=function(e){var t=this.parent?this.parent.stack:null;return t?t.ownStacking?t:t.getParentStack(e):e.stack},t.exports=o},{"./nodecontainer":14}],22:[function(e,t,n){function o(e){this.rangeBounds=this.testRangeBounds(e),this.cors=this.testCORS(),this.svg=this.testSVG()}o.prototype.testRangeBounds=function(e){var t,n,o,r,i=!1;return e.createRange&&(t=e.createRange(),t.getBoundingClientRect&&(n=e.createElement("boundtest"),n.style.height="123px",n.style.display="block",e.body.appendChild(n),t.selectNode(n),o=t.getBoundingClientRect(),r=o.height,123===r&&(i=!0),e.body.removeChild(n))),i},o.prototype.testCORS=function(){return void 0!==(new Image).crossOrigin},o.prototype.testSVG=function(){var e=new Image,t=document.createElement("canvas"),n=t.getContext("2d");e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),t.toDataURL()}catch(e){return!1}return!0},t.exports=o},{}],23:[function(e,t,n){function o(e){this.src=e,this.image=null;var t=this;this.promise=this.hasFabric().then(function(){return t.isInline(e)?Promise.resolve(t.inlineFormatting(e)):r(e)}).then(function(e){return new Promise(function(n){window.html2canvas.svg.fabric.loadSVGFromString(e,t.createCanvas.call(t,n))})})}var r=e("./xhr"),i=e("./utils").decode64;o.prototype.hasFabric=function(){return window.html2canvas.svg&&window.html2canvas.svg.fabric?Promise.resolve():Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},o.prototype.inlineFormatting=function(e){return/^data:image\/svg\+xml;base64,/.test(e)?this.decode64(this.removeContentType(e)):this.removeContentType(e)},o.prototype.removeContentType=function(e){return e.replace(/^data:image\/svg\+xml(;base64)?,/,"")},o.prototype.isInline=function(e){return/^data:image\/svg\+xml/i.test(e)},o.prototype.createCanvas=function(e){var t=this;return function(n,o){var r=new window.html2canvas.svg.fabric.StaticCanvas("c");t.image=r.lowerCanvasEl,r.setWidth(o.width).setHeight(o.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(n,o)).renderAll(),e(r.lowerCanvasEl)}},o.prototype.decode64=function(e){return"function"==typeof window.atob?window.atob(e):i(e)},t.exports=o},{"./utils":26,"./xhr":28}],24:[function(e,t,n){function o(e,t){this.src=e,this.image=null;var n=this;this.promise=t?new Promise(function(t,o){n.image=new Image,n.image.onload=t,n.image.onerror=o,n.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(e),!0===n.image.complete&&t(n.image)}):this.hasFabric().then(function(){return new Promise(function(t){window.html2canvas.svg.fabric.parseSVGDocument(e,n.createCanvas.call(n,t))})})}var r=e("./svgcontainer");o.prototype=Object.create(r.prototype),t.exports=o},{"./svgcontainer":23}],25:[function(e,t,n){function o(e,t){i.call(this,e,t)}function r(e,t,n){if(e.length>0)return t+n.toUpperCase()}var i=e("./nodecontainer");o.prototype=Object.create(i.prototype),o.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},o.prototype.transform=function(e){var t=this.node.data;switch(e){case"lowercase":return t.toLowerCase();case"capitalize":return t.replace(/(^|\s|:|-|\(|\))([a-z])/g,r);case"uppercase":return t.toUpperCase();default:return t}},t.exports=o},{"./nodecontainer":14}],26:[function(e,t,n){n.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},n.bind=function(e,t){return function(){return e.apply(t,arguments)}},n.decode64=function(e){var t,n,o,r,i,a,s,d,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=e.length,l="";for(t=0;t<c;t+=4)n=u.indexOf(e[t]),o=u.indexOf(e[t+1]),r=u.indexOf(e[t+2]),i=u.indexOf(e[t+3]),a=n<<2|o>>4,s=(15&o)<<4|r>>2,d=(3&r)<<6|i,l+=64===r?String.fromCharCode(a):64===i||-1===i?String.fromCharCode(a,s):String.fromCharCode(a,s,d);return l},n.getBounds=function(e){if(e.getBoundingClientRect){var t=e.getBoundingClientRect(),n=null==e.offsetWidth?t.width:e.offsetWidth;return{top:t.top,bottom:t.bottom||t.top+t.height,right:t.left+n,left:t.left,width:n,height:null==e.offsetHeight?t.height:e.offsetHeight}}return{}},n.offsetBounds=function(e){var t=e.offsetParent?n.offsetBounds(e.offsetParent):{top:0,left:0};return{top:e.offsetTop+t.top,bottom:e.offsetTop+e.offsetHeight+t.top,right:e.offsetLeft+t.left+e.offsetWidth,left:e.offsetLeft+t.left,width:e.offsetWidth,height:e.offsetHeight}},n.parseBackgrounds=function(e){var t,n,o,r,i,a,s,d=" \r\n\t",u=[],c=0,l=0,p=function(){t&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&s.push(n),"-"===t.substr(0,1)&&(r=t.indexOf("-",1)+1)>0&&(o=t.substr(0,r),t=t.substr(r)),u.push({prefix:o,method:t.toLowerCase(),value:i,args:s,image:null})),s=[],t=o=n=i=""};return s=[],t=o=n=i="",e.split("").forEach(function(e){if(!(0===c&&d.indexOf(e)>-1)){switch(e){case'"':a?a===e&&(a=null):a=e;break;case"(":if(a)break;if(0===c)return c=1,void(i+=e);l++;break;case")":if(a)break;if(1===c){if(0===l)return c=0,i+=e,void p();l--}break;case",":if(a)break;if(0===c)return void p();if(1===c&&0===l&&!t.match(/^url$/i))return s.push(n),n="",void(i+=e)}i+=e,0===c?t+=e:n+=e}}),p(),u}},{}],27:[function(e,t,n){function o(e){r.apply(this,arguments),this.type="linear"===e.args[0]?r.TYPES.LINEAR:r.TYPES.RADIAL}var r=e("./gradientcontainer");o.prototype=Object.create(r.prototype),t.exports=o},{"./gradientcontainer":9}],28:[function(e,t,n){function o(e){return new Promise(function(t,n){var o=new XMLHttpRequest;o.open("GET",e),o.onload=function(){200===o.status?t(o.responseText):n(new Error(o.statusText))},o.onerror=function(){n(new Error("Network Error"))},o.send()})}t.exports=o},{}]},{},[4])(4)})}).call(t,n(1))},122:function(e,t,n){(function(n){var o,r;/*!
 *  howler.js v2.0.5
 *  howlerjs.com
 *
 *  (c) 2013-2017, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
!function(){"use strict";var i=function(){this.init()};i.prototype={init:function(){var e=this||a;return e._counter=1e3,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var t=this||a;if(e=parseFloat(e),t.ctx||f(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&(t.masterGain.gain.value=e);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var o=t._howls[n]._getSoundIds(),r=0;r<o.length;r++){var i=t._howls[n]._soundById(o[r]);i&&i._node&&(i._node.volume=i._volume*e)}return t}return t._volume},mute:function(e){var t=this||a;t.ctx||f(),t._muted=e,t.usingWebAudio&&(t.masterGain.gain.value=e?0:t._volume);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var o=t._howls[n]._getSoundIds(),r=0;r<o.length;r++){var i=t._howls[n]._soundById(o[r]);i&&i._node&&(i._node.muted=!!e||i._muted)}return t},unload:function(){for(var e=this||a,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,f()),e},codecs:function(e){return(this||a)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||a;if(e.state=e.ctx?e.ctx.state||"running":"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{var t=new Audio;void 0===t.oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||a,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),o=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),r=o&&parseInt(o[0].split("/")[1],10)<33;return e._codecs={mp3:!(r||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||a,t=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),n=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(t||n)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var o=function(){a._autoResume();var t=e.ctx.createBufferSource();t.buffer=e._scratchBuffer,t.connect(e.ctx.destination),void 0===t.start?t.noteOn(0):t.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),t.onended=function(){t.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0)}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&a.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&a.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var a=new i,s=function(e){var t=this;if(!e.src||0===e.src.length)return void console.error("An array of source files must be passed with any new Howl.");t.init(e)};s.prototype={init:function(e){var t=this;return a.ctx||f(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhrWithCredentials=e.xhrWithCredentials||!1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onresume=[],t._webAudio=a.usingWebAudio&&!t._html5,void 0!==a.ctx&&a.ctx&&a.mobileAutoEnable&&a._enableMobileAudio(),a._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t.load(),t},load:function(){var e=this,t=null;if(a.noAudio)return void e._emit("loaderror",null,"No audio support.");"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var o,r;if(e._format&&e._format[n])o=e._format[n];else{if("string"!=typeof(r=e._src[n])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}o=/^data:audio\/([^;,]+);/i.exec(r),o||(o=/\.([^.]+)$/.exec(r.split("?",1)[0])),o&&(o=o[1].toLowerCase())}if(o||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),o&&a.codecs(o)){t=e._src[n];break}}return t?(e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new d(e),e._webAudio&&c(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(e,t){var n=this,o=null;if("number"==typeof e)o=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if(void 0===e){e="__default";for(var r=0,i=0;i<n._sounds.length;i++)n._sounds[i]._paused&&!n._sounds[i]._ended&&(r++,o=n._sounds[i]._id);1===r?e=null:o=null}}var s=o?n._soundById(o):n._inactiveSound();if(!s)return null;if(o&&!e&&(e=s._sprite||"__default"),"loaded"!==n._state){s._sprite=e,s._ended=!1;var d=s._id;return n._queue.push({event:"play",action:function(){n.play(d)}}),d}if(o&&!s._paused)return t||setTimeout(function(){n._emit("play",s._id)},0),s._id;n._webAudio&&a._autoResume();var u=Math.max(0,s._seek>0?s._seek:n._sprite[e][0]/1e3),c=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-u),l=1e3*c/Math.abs(s._rate);s._paused=!1,s._ended=!1,s._sprite=e,s._seek=u,s._start=n._sprite[e][0]/1e3,s._stop=(n._sprite[e][0]+n._sprite[e][1])/1e3,s._loop=!(!s._loop&&!n._sprite[e][2]);var p=s._node;if(n._webAudio){var h=function(){n._refreshBuffer(s);var e=s._muted||n._muted?0:s._volume;p.gain.setValueAtTime(e,a.ctx.currentTime),s._playStart=a.ctx.currentTime,void 0===p.bufferSource.start?s._loop?p.bufferSource.noteGrainOn(0,u,86400):p.bufferSource.noteGrainOn(0,u,c):s._loop?p.bufferSource.start(0,u,86400):p.bufferSource.start(0,u,c),l!==1/0&&(n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),l)),t||setTimeout(function(){n._emit("play",s._id)},0)};"running"===a.state?h():(n.once("resume",h),n._clearTimer(s._id))}else{var f=function(){p.currentTime=u,p.muted=s._muted||n._muted||a._muted||p.muted,p.volume=s._volume*a.volume(),p.playbackRate=s._rate;try{if(p.play(),p.paused)return void n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices where playback was not within a user interaction.");l!==1/0&&(n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),l)),t||n._emit("play",s._id)}catch(e){n._emit("playerror",s._id,e)}},m=window&&window.ejecta||!p.readyState&&a._navigator.isCocoonJS;if(4===p.readyState||m)f();else{var g=function(){f(),p.removeEventListener(a._canPlayEvent,g,!1)};p.addEventListener(a._canPlayEvent,g,!1),n._clearTimer(s._id)}}return s._id},pause:function(e){var t=this;if("loaded"!==t._state)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),o=0;o<n.length;o++){t._clearTimer(n[o]);var r=t._soundById(n[o]);if(r&&!r._paused&&(r._seek=t.seek(n[o]),r._rateSeek=0,r._paused=!0,t._stopFade(n[o]),r._node))if(t._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),t._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||t._emit("pause",r?r._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var o=n._getSoundIds(e),r=0;r<o.length;r++){n._clearTimer(o[r]);var i=n._soundById(o[r]);i&&(i._seek=i._start||0,i._rateSeek=0,i._paused=!0,i._ended=!0,n._stopFade(o[r]),i._node&&(n._webAudio?i._node.bufferSource&&(void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),n._cleanBuffer(i._node)):isNaN(i._node.duration)&&i._node.duration!==1/0||(i._node.currentTime=i._start||0,i._node.pause())),t||n._emit("stop",i._id))}return n},mute:function(e,t){var n=this;if("loaded"!==n._state)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var o=n._getSoundIds(t),r=0;r<o.length;r++){var i=n._soundById(o[r]);i&&(i._muted=e,n._webAudio&&i._node?i._node.gain.setValueAtTime(e?0:i._volume,a.ctx.currentTime):i._node&&(i._node.muted=!!a._muted||e),n._emit("mute",i._id))}return n},volume:function(){var e,t,n=this,o=arguments;if(0===o.length)return n._volume;if(1===o.length||2===o.length&&void 0===o[1]){n._getSoundIds().indexOf(o[0])>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else o.length>=2&&(e=parseFloat(o[0]),t=parseInt(o[1],10));var r;if(!(void 0!==e&&e>=0&&e<=1))return r=t?n._soundById(t):n._sounds[0],r?r._volume:0;if("loaded"!==n._state)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,o)}}),n;void 0===t&&(n._volume=e),t=n._getSoundIds(t);for(var i=0;i<t.length;i++)(r=n._soundById(t[i]))&&(r._volume=e,o[2]||n._stopFade(t[i]),n._webAudio&&r._node&&!r._muted?r._node.gain.setValueAtTime(e,a.ctx.currentTime):r._node&&!r._muted&&(r._node.volume=e*a.volume()),n._emit("volume",r._id));return n},fade:function(e,t,n,o){var r=this;if("loaded"!==r._state)return r._queue.push({event:"fade",action:function(){r.fade(e,t,n,o)}}),r;r.volume(e,o);for(var i=r._getSoundIds(o),s=0;s<i.length;s++){var d=r._soundById(i[s]);if(d){if(o||r._stopFade(i[s]),r._webAudio&&!d._muted){var u=a.ctx.currentTime,c=u+n/1e3;d._volume=e,d._node.gain.setValueAtTime(e,u),d._node.gain.linearRampToValueAtTime(t,c)}r._startFadeInterval(d,e,t,n,i[s])}}return r},_startFadeInterval:function(e,t,n,o,r){var i=this,a=t,s=t>n?"out":"in",d=Math.abs(t-n),u=d/.01,c=u>0?o/u:o;c<4&&(u=Math.ceil(u/(4/c)),c=4),e._interval=setInterval(function(){u>0&&(a+="in"===s?.01:-.01),a=Math.max(0,a),a=Math.min(1,a),a=Math.round(100*a)/100,i._webAudio?(void 0===r&&(i._volume=a),e._volume=a):i.volume(a,e._id,!0),(n<t&&a<=n||n>t&&a>=n)&&(clearInterval(e._interval),e._interval=null,i.volume(n,e._id),i._emit("fade",e._id))},c)},_stopFade:function(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(a.ctx.currentTime),clearInterval(n._interval),n._interval=null,t._emit("fade",e)),t},loop:function(){var e,t,n,o=this,r=arguments;if(0===r.length)return o._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(n=o._soundById(parseInt(r[0],10)))&&n._loop;e=r[0],o._loop=e}else 2===r.length&&(e=r[0],t=parseInt(r[1],10));for(var i=o._getSoundIds(t),a=0;a<i.length;a++)(n=o._soundById(i[a]))&&(n._loop=e,o._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return o},rate:function(){var e,t,n=this,o=arguments;if(0===o.length)t=n._sounds[0]._id;else if(1===o.length){var r=n._getSoundIds(),i=r.indexOf(o[0]);i>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else 2===o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10));var s;if("number"!=typeof e)return s=n._soundById(t),s?s._rate:n._rate;if("loaded"!==n._state)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,o)}}),n;void 0===t&&(n._rate=e),t=n._getSoundIds(t);for(var d=0;d<t.length;d++)if(s=n._soundById(t[d])){s._rateSeek=n.seek(t[d]),s._playStart=n._webAudio?a.ctx.currentTime:s._playStart,s._rate=e,n._webAudio&&s._node&&s._node.bufferSource?s._node.bufferSource.playbackRate.value=e:s._node&&(s._node.playbackRate=e);var u=n.seek(t[d]),c=(n._sprite[s._sprite][0]+n._sprite[s._sprite][1])/1e3-u,l=1e3*c/Math.abs(s._rate);!n._endTimers[t[d]]&&s._paused||(n._clearTimer(t[d]),n._endTimers[t[d]]=setTimeout(n._ended.bind(n,s),l)),n._emit("rate",s._id)}return n},seek:function(){var e,t,n=this,o=arguments;if(0===o.length)t=n._sounds[0]._id;else if(1===o.length){var r=n._getSoundIds(),i=r.indexOf(o[0]);i>=0?t=parseInt(o[0],10):n._sounds.length&&(t=n._sounds[0]._id,e=parseFloat(o[0]))}else 2===o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if(void 0===t)return n;if("loaded"!==n._state)return n._queue.push({event:"seek",action:function(){n.seek.apply(n,o)}}),n;var s=n._soundById(t);if(s){if(!("number"==typeof e&&e>=0)){if(n._webAudio){var d=n.playing(t)?a.ctx.currentTime-s._playStart:0,u=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(u+d*Math.abs(s._rate))}return s._node.currentTime}var c=n.playing(t);c&&n.pause(t,!0),s._seek=e,s._ended=!1,n._clearTimer(t),c&&n.play(t,!0),!n._webAudio&&s._node&&(s._node.currentTime=e),n._emit("seek",t)}return n},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var o=0;o<t._sounds.length;o++)if(!t._sounds[o]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,o=t._soundById(e);return o&&(n=t._sprite[o._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++){if(t[n]._paused||e.stop(t[n]._id),!e._webAudio){/MSIE |Trident\//.test(a._navigator&&a._navigator.userAgent)||(t[n]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(a._canPlayEvent,t[n]._loadFn,!1)}delete t[n]._node,e._clearTimer(t[n]._id);var o=a._howls.indexOf(e);o>=0&&a._howls.splice(o,1)}var r=!0;for(n=0;n<a._howls.length;n++)if(a._howls[n]._src===e._src){r=!1;break}return u&&r&&delete u[e._src],a.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,o){var r=this,i=r["_on"+e];return"function"==typeof t&&i.push(o?{id:n,fn:t,once:o}:{id:n,fn:t}),r},off:function(e,t,n){var o=this,r=o["_on"+e],i=0;if("number"==typeof t&&(n=t,t=null),t||n)for(i=0;i<r.length;i++){var a=n===r[i].id;if(t===r[i].fn&&a||!t&&a){r.splice(i,1);break}}else if(e)o["_on"+e]=[];else{var s=Object.keys(o);for(i=0;i<s.length;i++)0===s[i].indexOf("_on")&&Array.isArray(o[s[i]])&&(o[s[i]]=[])}return o},once:function(e,t,n){var o=this;return o.on(e,t,n,1),o},_emit:function(e,t,n){for(var o=this,r=o["_on"+e],i=r.length-1;i>=0;i--)r[i].id&&r[i].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(o,r[i].fn),0),r[i].once&&o.off(e,r[i].fn,r[i].id));return o},_loadQueue:function(){var e=this;if(e._queue.length>0){var t=e._queue[0];e.once(t.event,function(){e._queue.shift(),e._loadQueue()}),t.action()}return e},_ended:function(e){var t=this,n=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused)return setTimeout(t._ended.bind(t,e),100),t;var o=!(!e._loop&&!t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&o&&t.stop(e._id,!0).play(e._id),t._webAudio&&o){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=a.ctx.currentTime;var r=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),r)}return t._webAudio&&!o&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),a._autoSuspend()),t._webAudio||o||t.stop(e._id),t},_clearTimer:function(e){var t=this;return t._endTimers[e]&&(clearTimeout(t._endTimers[e]),delete t._endTimers[e]),t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new d(e)},_drain:function(){var e=this,t=e._pool,n=0,o=0;if(!(e._sounds.length<t)){for(o=0;o<e._sounds.length;o++)e._sounds[o]._ended&&n++;for(o=e._sounds.length-1;o>=0;o--){if(n<=t)return;e._sounds[o]._ended&&(e._webAudio&&e._sounds[o]._node&&e._sounds[o]._node.disconnect(0),e._sounds.splice(o,1),n--)}}},_getSoundIds:function(e){var t=this;if(void 0===e){for(var n=[],o=0;o<t._sounds.length;o++)n.push(t._sounds[o]._id);return n}return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=a.ctx.createBufferSource(),e._node.bufferSource.buffer=u[t._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.value=e._rate,t},_cleanBuffer:function(e){var t=this;if(t._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=t._scratchBuffer}catch(e){}}return e.bufferSource=null,t}};var d=function(e){this._parent=e,this.init()};d.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++a._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=a._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===a.ctx.createGain?a.ctx.createGainNode():a.ctx.createGain(),e._node.gain.setValueAtTime(n,a.ctx.currentTime),e._node.paused=!0,e._node.connect(a.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(a._canPlayEvent,e._loadFn,!1),e._node.src=t._src,e._node.preload="auto",e._node.volume=n*a.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++a._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(a._canPlayEvent,e._loadFn,!1)}};var u={},c=function(e){var t=e._src;if(u[t])return e._duration=u[t].duration,void h(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),o=new Uint8Array(n.length),r=0;r<n.length;++r)o[r]=n.charCodeAt(r);p(o.buffer,e)}else{var i=new XMLHttpRequest;i.open("GET",t,!0),i.withCredentials=e._xhrWithCredentials,i.responseType="arraybuffer",i.onload=function(){var t=(i.status+"")[0];if("0"!==t&&"2"!==t&&"3"!==t)return void e._emit("loaderror",null,"Failed loading audio file with status: "+i.status+".");p(i.response,e)},i.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete u[t],e.load())},l(i)}},l=function(e){try{e.send()}catch(t){e.onerror()}},p=function(e,t){a.ctx.decodeAudioData(e,function(e){e&&t._sounds.length>0&&(u[t._src]=e,h(t,e))},function(){t._emit("loaderror",null,"Decoding audio data failed.")})},h=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},f=function(){try{"undefined"!=typeof AudioContext?a.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?a.ctx=new webkitAudioContext:a.usingWebAudio=!1}catch(e){a.usingWebAudio=!1}var e=/iP(hone|od|ad)/.test(a._navigator&&a._navigator.platform),t=a._navigator&&a._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var o=/safari/.test(a._navigator&&a._navigator.userAgent.toLowerCase());(a._navigator&&a._navigator.standalone&&!o||a._navigator&&!a._navigator.standalone&&!o)&&(a.usingWebAudio=!1)}a.usingWebAudio&&(a.masterGain=void 0===a.ctx.createGain?a.ctx.createGainNode():a.ctx.createGain(),a.masterGain.gain.value=a._muted?0:1,a.masterGain.connect(a.ctx.destination)),a._setup()};o=[],void 0!==(r=function(){return{Howler:a,Howl:s}}.apply(t,o))&&(e.exports=r),t.Howler=a,t.Howl=s,"undefined"!=typeof window?(window.HowlerGlobal=i,window.Howler=a,window.Howl=s,window.Sound=d):void 0!==n&&(n.HowlerGlobal=i,n.Howler=a,n.Howl=s,n.Sound=d)}(),/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.0.5
 *  howlerjs.com
 *
 *  (c) 2013-2017, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var o=this;return o.ctx&&o.ctx.listener?(t="number"!=typeof t?o._pos[1]:t,n="number"!=typeof n?o._pos[2]:n,"number"!=typeof e?o._pos:(o._pos=[e,t,n],o.ctx.listener.setPosition(o._pos[0],o._pos[1],o._pos[2]),o)):o},HowlerGlobal.prototype.orientation=function(e,t,n,o,r,i){var a=this;if(!a.ctx||!a.ctx.listener)return a;var s=a._orientation;return t="number"!=typeof t?s[1]:t,n="number"!=typeof n?s[2]:n,o="number"!=typeof o?s[3]:o,r="number"!=typeof r?s[4]:r,i="number"!=typeof i?s[5]:i,"number"!=typeof e?s:(a._orientation=[e,t,n,o,r,i],a.ctx.listener.setOrientation(e,t,n,o,r,i),a)},Howl.prototype.init=function(e){return function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,n){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"stereo",action:function(){o.stereo(t,n)}}),o;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof t)return o._stereo;o._stereo=t,o._pos=[t,0,0]}for(var i=o._getSoundIds(n),a=0;a<i.length;a++){var s=o._soundById(i[a]);if(s){if("number"!=typeof t)return s._stereo;s._stereo=t,s._pos=[t,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||e(s,r),"spatial"===r?s._panner.setPosition(t,0,0):s._panner.pan.value=t),o._emit("stereo",s._id)}}return o},Howl.prototype.pos=function(t,n,o,r){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"pos",action:function(){i.pos(t,n,o,r)}}),i;if(n="number"!=typeof n?0:n,o="number"!=typeof o?-.5:o,void 0===r){if("number"!=typeof t)return i._pos;i._pos=[t,n,o]}for(var a=i._getSoundIds(r),s=0;s<a.length;s++){var d=i._soundById(a[s]);if(d){if("number"!=typeof t)return d._pos;d._pos=[t,n,o],d._node&&(d._panner&&!d._panner.pan||e(d,"spatial"),d._panner.setPosition(t,n,o)),i._emit("pos",d._id)}}return i},Howl.prototype.orientation=function(t,n,o,r){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"orientation",action:function(){i.orientation(t,n,o,r)}}),i;if(n="number"!=typeof n?i._orientation[1]:n,o="number"!=typeof o?i._orientation[2]:o,void 0===r){if("number"!=typeof t)return i._orientation;i._orientation=[t,n,o]}for(var a=i._getSoundIds(r),s=0;s<a.length;s++){var d=i._soundById(a[s]);if(d){if("number"!=typeof t)return d._orientation;d._orientation=[t,n,o],d._node&&(d._panner||(d._pos||(d._pos=i._pos||[0,0,-.5]),e(d,"spatial")),d._panner.setOrientation(t,n,o)),i._emit("orientation",d._id)}}return i},Howl.prototype.pannerAttr=function(){var t,n,o,r=this,i=arguments;if(!r._webAudio)return r;if(0===i.length)return r._pannerAttr;if(1===i.length){if("object"!=typeof i[0])return o=r._soundById(parseInt(i[0],10)),o?o._pannerAttr:r._pannerAttr;t=i[0],void 0===n&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),r._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:r._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:r._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:r._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:r._panningModel})}else 2===i.length&&(t=i[0],n=parseInt(i[1],10));for(var a=r._getSoundIds(n),s=0;s<a.length;s++)if(o=r._soundById(a[s])){var d=o._pannerAttr;d={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:d.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:d.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:d.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:d.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:d.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:d.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:d.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:d.panningModel};var u=o._panner;u?(u.coneInnerAngle=d.coneInnerAngle,u.coneOuterAngle=d.coneOuterAngle,u.coneOuterGain=d.coneOuterGain,u.distanceModel=d.distanceModel,u.maxDistance=d.maxDistance,u.refDistance=d.refDistance,u.rolloffFactor=d.rolloffFactor,u.panningModel=d.panningModel):(o._pos||(o._pos=r._pos||[0,0,-.5]),e(o,"spatial"))}return r},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this)}}(Sound.prototype.reset);var e=function(e,t){t=t||"spatial","spatial"===t?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.value=e._stereo),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id)}}()}).call(t,n(1))}});